montageDefine("b7b5e36","data/service/data-service",{dependencies:["core/core","data/service/authorization-manager","data/service/authorization-policy","data/model/data-object-descriptor","data/model/data-query","data/service/data-stream","data/service/data-trigger","collections/map","core/promise","core/meta/object-descriptor","collections/set","collections/weak-map"],factory:function(e,t,i){var r=e("core/core").Montage,n=e("data/service/authorization-manager").AuthorizationManager,o=e("data/service/authorization-policy").AuthorizationPolicy,a=e("data/model/data-object-descriptor").DataObjectDescriptor,s=e("data/model/data-query").DataQuery,l=e("data/service/data-stream").DataStream,u=e("data/service/data-trigger").DataTrigger,c=e("collections/map"),h=e("core/promise").Promise,d=e("core/meta/object-descriptor").ObjectDescriptor,p=e("collections/set"),v=e("collections/weak-map"),m=new r;m.NoAuthorizationPolicy=o.NONE,m.UpfrontAuthorizationPolicy=o.UP_FRONT,m.OnDemandAuthorizationPolicy=o.ON_DEMAND,m.OnFirstFetchAuthorizationPolicy=o.ON_FIRST_FETCH,t.DataService=r.specialize({constructor:{value:function(){t.DataService.mainService=t.DataService.mainService||this,this._initializeAuthorization(),this._initializeOffline()}},deserializeSelf:{value:function(e){var t;t=e.getProperty("childServices"),t&&this.registerChildServices(t),t=e.getProperty("model")||e.getProperty("binder"),t&&(this.model=t),t=!this.model&&e.getProperty("types"),t&&Array.prototype.push.apply(this._childServiceTypes,t),t=e.getProperty("mappings"),t&&Array.prototype.push.apply(this._childServiceMappings,t),t=e.getProperty("delegate"),t&&(this.delegate=t)}},delegate:{value:null},types:{get:function(){return this._childServiceTypes}},mappings:{get:function(){return this._childServiceMappings}},parentService:{get:function(){return this._parentService}},_parentService:{value:void 0},rootService:{get:function(){return this.parentService?this.parentService.rootService:this}},isRootService:{get:function(){return this===this.rootService}},childServices:{get:function(){return this._childServices||(this._childServices=new p),this._childServices}},_childServices:{value:void 0},addChildService:{value:function(e,i){e instanceof t.DataService&&e.constructor!==t.DataService?this._addChildService(e,i):(console.warn("Cannot add child -",e),console.warn("Children must be instances of DataService subclasses."))}},_addChildService:{value:function(e,t){var i,r,n,o,a=1;for(t=t||e.model&&e.model.objectDescriptors||e.types,e._parentService&&e._parentService.removeChildService(e),this.childServices.add(e),this._childServicesByIdentifier.set(e.identifier,e),n=0,o=t&&t.length||a;n<o;n+=1)r=t&&t.length&&t[n]||null,i=this._childServicesByType.get(r)||[],i.push(e),1===i.length&&(this._childServicesByType.set(r,i),r&&this._childServiceTypes.push(r));e._parentService=this}},__childServiceRegistrationPromise:{value:null},_childServiceRegistrationPromise:{get:function(){return this.__childServiceRegistrationPromise||(this.__childServiceRegistrationPromise=h.resolve())},set:function(e){this.__childServiceRegistrationPromise=e}},registerChildServices:{value:function(e){var t;this.__childServiceRegistrationPromise||(t=this,this.__childServiceRegistrationPromise=h.all(e.map(function(e){return t.registerChildService(e)})))}},registerChildService:{value:function(e,t){var i=this,r=e.mappings||[];return t=t&&Array.isArray(t)&&t||t&&[t]||e.model&&e.model.objectDescriptors||e.types&&Array.isArray(e.types)&&e.types||e.types&&[e.types]||[],e._childServiceRegistrationPromise.then(function(){return i._registerChildServiceTypesAndMappings(e,t,r)})}},_registerChildServiceTypesAndMappings:{value:function(e,t,i){var r,n=this;return this._resolveAsynchronousTypes(t).then(function(t){return r=t,n._registerTypesByModuleId(r),n._registerChildServiceMappings(e,i)}).then(function(){return n._makePrototypesForTypes(r)}).then(function(){return n.addChildService(e,t),null})}},_resolveAsynchronousTypes:{value:function(e){var t=this;return h.all(this._flattenArray(e).map(function(e){return e instanceof h?e:h.resolve(e)})).then(function(e){return t._flattenArray(e)})}},_flattenArray:{value:function(e){return Array.prototype.concat.apply([],e)}},_registerTypesByModuleId:{value:function(e){var t=this._moduleIdToObjectDescriptorMap;e.forEach(function(e){var i=e.module,r=[i.id,e.exportName].join("/");t[r]=e})}},_registerChildServiceMappings:{value:function(e,t){var i=this;return h.all(t.map(function(t){return i._addMappingToChild(t,e)}))}},_makePrototypesForTypes:{value:function(e){var t=this;return h.all(e.map(function(e){return t._makePrototypeForType(e)}))}},_makePrototypeForType:{value:function(e){var t=this,i=e.module;return i.require.async(i.id).then(function(i){var r=i[e.exportName],n=Object.create(r.prototype),o=t.mappingWithType(e),a=o&&o.requisitePropertyNames||new p,s=u.addTriggers(t,e,n,a);return t._dataObjectPrototypes.set(r,n),t._dataObjectPrototypes.set(e,n),t._dataObjectTriggers.set(e,s),t._constructorToObjectDescriptorMap.set(r,e),null})}},_addMappingToChild:{value:function(e,t){var i=this;return h.all([e.objectDescriptorReference,e.schemaDescriptorReference]).spread(function(r,n){var o=[r.module.id,r.name].join("/");return r=i._moduleIdToObjectDescriptorMap[o],e.objectDescriptor=r,e.schemaDescriptor=n,e.service=t,t.addMappingForType(e,r),null})}},_objectDescriptorForType:{value:function(e){return this._constructorToObjectDescriptorMap.get(e)||"string"==typeof e&&this._moduleIdToObjectDescriptorMap[e]||e}},_constructorToObjectDescriptorMap:{get:function(){return this.__constructorToObjectDescriptorMap||(this.__constructorToObjectDescriptorMap=new c),this.__constructorToObjectDescriptorMap}},_moduleIdToObjectDescriptorMap:{get:function(){return this.__moduleIdToObjectDescriptorMap||(this.__moduleIdToObjectDescriptorMap={}),this.__moduleIdToObjectDescriptorMap}},removeChildService:{value:function(e,t){var i,r,n,o,a;for(t=t||e.types,o=0,a=t&&t.length||1;o<a;o+=1)i=t&&t.length&&t[o]||null,r=this._childServicesByType.get(i),n=r?r.indexOf(e):-1,n>=0&&r.length>1?r.splice(n,1):0===n&&(this._childServicesByType["delete"](i),n=i?this._childServiceTypes.indexOf(i):-1,n>=0&&this._childServiceTypes.splice(n,1));this.childServices["delete"](e),e._parentService===this&&(e._parentService=void 0)}},unregisterChildService:{value:function(e){var t=this;return new h(function(i,r){t.removeChildService(e,e.types),i()})}},_childServicesByType:{get:function(){return this.__childServicesByType||(this.__childServicesByType=new c),this.__childServicesByType}},__childServicesByType:{value:void 0},_childServicesByIdentifier:{get:function(){return this.__childServicesByIdentifier||(this.__childServicesByIdentifier=new c),this.__childServicesByIdentifier}},__childServicesByIdentifier:{value:void 0},_childServiceTypes:{get:function(){return this.__childServiceTypes||(this.__childServiceTypes=[]),this.__childServiceTypes}},__childServiceTypes:{value:void 0},_getChildServiceForObject:{value:function(e){return this.childServiceForType(this.rootService._getObjectType(e))}},childServiceForType:{value:function(e){var t;return e=e instanceof d?e:this._objectDescriptorForType(e),t=this._childServicesByType.get(e)||this._childServicesByType.get(null),t&&t[0]||null}},addMappingForType:{value:function(e,t){this._mappingByType.set(t,e)}},mappingWithType:{value:function(e){var t;return e=this._objectDescriptorForType(e),t=this._mappingByType.has(e)&&this._mappingByType.get(e),t||null}},_mappingByType:{get:function(){return this.__mappingByType||(this.__mappingByType=new c),this.__mappingByType}},__mappingByType:{value:void 0},_childServiceMappings:{get:function(){return this.__childServiceMappings||(this.__childServiceMappings=[]),this.__childServiceMappings}},__childServiceMappings:{value:void 0},model:{value:void 0},dataMaxAge:{value:void 0},_initializeAuthorization:{value:function(){if(this.providesAuthorization&&t.DataService.authorizationManager.registerAuthorizationService(this),this.authorizationPolicy===m.UpfrontAuthorizationPolicy){var e=this;t.DataService.authorizationManager.authorizeService(this).then(function(t){return e.authorization=t,t})["catch"](function(e){console.log(e)})}else this.authorizationPromise=h.resolve()}},authorizationPolicy:{value:m.NoAuthorizationPolicy},authorization:{value:void 0},authorizationPromise:{value:h.resolve()},authorizationServices:{value:null},authorizationPanel:{value:void 0},providesAuthorization:{value:!1},authorize:{value:function(){return console.warn("DataService.authorize() must be overridden by the implementing service",arguments),this.nullPromise}},logOut:{value:function(){return console.warn("DataService.logOut() must be overridden by the implementing service"),this.nullPromise}},objectDescriptorForObject:{value:function(e){var t,i,n,o,a,s=this.types,l=r.getInfoForObject(e),u=l.moduleId,c=l.objectName;for(o=0,a=s.length;o<a&&!n;o+=1)t=s[o].module,i=t&&s[o].exportName,t&&u===t.id&&c===i&&(n=s[o]);return n||this.parentService&&this.parentService.objectDescriptorForObject(e)}},_getObjectType:{value:function(e){for(var t=this._typeRegistry.get(e),i="string"==typeof e?e:this._getModuleIdForObject(e);!t&&e;)e.constructor.TYPE instanceof a?t=e.constructor.TYPE:this._moduleIdToObjectDescriptorMap[i]?t=this._moduleIdToObjectDescriptorMap[i]:e=Object.getPrototypeOf(e);return t}},_getModuleIdForObject:{value:function(e){var t=r.getInfoForObject(e);return[t.moduleId,t.objectName].join("/")}},_setObjectType:{value:function(e,t){this._getObjectType(e)!==t&&this._typeRegistry.set(e,t)}},_typeRegistry:{get:function(){return this.__typeRegistry||(this.__typeRegistry=new v),this.__typeRegistry}},_getPrototypeForType:{value:function(e){var t;return e=this._objectDescriptorForType(e),t=this._dataObjectPrototypes.get(e),e&&!t&&(t=Object.create(e.objectPrototype||r.prototype),this._dataObjectPrototypes.set(e,t),this._dataObjectTriggers.set(e,u.addTriggers(this,e,t))),t}},_getTriggersForObject:{value:function(e){var t=this._getObjectType(e);return t&&this._dataObjectTriggers.get(t)}},_dataObjectPrototypes:{get:function(){return this.__dataObjectPrototypes||(this.__dataObjectPrototypes=new c),this.__dataObjectPrototypes}},__dataObjectPrototypes:{value:void 0},_dataObjectTriggers:{get:function(){return this.__dataObjectTriggers||(this.__dataObjectTriggers=new c),this.__dataObjectTriggers}},__dataObjectTriggers:{value:void 0},decacheObjectProperties:{value:function(e,t){if(this.isRootService){var i,r,n,o=Array.isArray(t)?t:arguments,a=o===t?0:1,s=this._getTriggersForObject(e);for(r=a,n=o.length;r<n;r+=1)i=s&&s[o[r]],i&&i.decacheObjectProperty(e)}else this.rootService.decacheObjectProperties(e,t)}},getObjectProperties:{value:function(e,t){if(this.isRootService){var i=Array.isArray(t)?t:arguments,r=i===t?0:1;return this._getOrUpdateObjectProperties(e,i,r,!1)}return this.rootService.getObjectProperties(e,t)}},getObjectPropertyExpressions:{value:function(e,t){if(this.isRootService){var i=Array.isArray(t)?t:arguments,r=[],n=this;return i.forEach(function(t){var i=t.split(".");r.push(n._getPropertiesOnPath(e,i))}),h.all(r)}return this.rootService.getObjectPropertyExpressions(e,t)}},_getPropertiesOnPath:{value:function(e,t){var i=this,r=t.shift(),n=this.getObjectProperties(e,r);return n?n.then(function(){var n=null;return t.length&&e[r]&&(n=i._getPropertiesOnPath(e[r],t)),n}):this.nullPromise}},updateObjectProperties:{value:function(e,t){if(this.isRootService){var i=Array.isArray(t)?t:arguments,r=i===t?0:1;return this._getOrUpdateObjectProperties(e,i,r,!0)}return this.rootService.updateObjectProperties(e,t)}},fetchObjectProperty:{value:function(e,t){var i=this.parentService&&this.parentService._getChildServiceForObject(e)===this,r=i&&"function"==typeof this.fetchRawObjectProperty,n=!r&&i&&this._delegateFunctionForPropertyName(t),o=!r&&!n&&i&&this._propertyDescriptorForObjectAndName(e,t),a=!i&&this._getChildServiceForObject(e);return r?this.fetchRawObjectProperty(e,t):n?n.call(this,e):i&&o?this._fetchObjectPropertyWithPropertyDescriptor(e,t,o):a?a.fetchObjectProperty(e,t):this.nullPromise}},_delegateFunctionForPropertyName:{value:function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),i="fetch"+t+"Property";return"function"==typeof this[i]&&this[i]}},_fetchObjectPropertyWithPropertyDescriptor:{value:function(e,t,i){var r=this,n=i.owner,o=n&&this.mappingWithType(n),a={};return o?(Object.assign(a,this.snapshotForObject(e)),o.mapObjectToCriteriaSourceForProperty(e,a,t).then(function(){return Object.assign(a,r.snapshotForObject(e)),o.mapRawDataToObjectProperty(a,e,t)})):this.nullPromise}},_getOrUpdateObjectProperties:{value:function(e,t,i,r){var n,o,a,s,l,u;for(n=this._getTriggersForObject(e),l=i,u=t.length;l<u;l+=1)o=n&&n[t[l]],s=o?r?o.updateObjectProperty(e):o.getObjectProperty(e):this.nullPromise,s!==this.nullPromise&&(a?a.set||a.array[0]===s?a.set&&!a.set.has(s)&&(a.set.add(s),a.array.push(s)):(a.set=new p,a.set.add(a.array[0]),a.set.add(s),a.array.push(s)):a={array:[s]});return a?a.set?h.all(a.array).then(this.nullFunction):a.array[0]:this.nullPromise}},getDataObject:{value:function(e,t,i,r){if(this.isRootService){var n;return this.isUniquing&&r&&(n=this.objectForDataIdentifier(r)),n||(n=this._createDataObject(e,r)),n}return this.rootService.getDataObject(e,t,i,r)}},isUniquing:{value:!1},_identifier:{value:void 0},identifier:{get:function(){return this._identifier||(this._identifier=r.getInfoForObject(this).moduleId)}},__dataIdentifierByObject:{value:null},_dataIdentifierByObject:{get:function(){return this.__objectsByDataIdentifier||(this.__objectsByDataIdentifier=new v)}},dataIdentifierForObject:{value:function(e){return this._dataIdentifierByObject.get(e)}},recordDataIdentifierForObject:{value:function(e,t){this._dataIdentifierByObject.set(t,e)}},removeDataIdentifierForObject:{value:function(e){this._dataIdentifierByObject["delete"](e)}},__objectByDataIdentifier:{value:null},_objectByDataIdentifier:{get:function(){return this.__objectByDataIdentifier||(this.__objectByDataIdentifier=new v)}},objectForDataIdentifier:{value:function(e){return this._objectByDataIdentifier.get(e)}},recordObjectForDataIdentifier:{value:function(e,t){this._objectByDataIdentifier.set(t,e)}},removeObjectForDataIdentifier:{value:function(e){this._objectByDataIdentifier["delete"](e)}},createDataObject:{value:function(e){if(this.isRootService){var t=this._createDataObject(e);return this.createdDataObjects.add(t),t}this.rootService.createDataObject(e)}},_createDataObject:{value:function(e,t){var i=this._objectDescriptorForType(e),r=Object.create(this._getPrototypeForType(i));return r&&(this.registerUniqueObjectWithDataIdentifier(r,t),r=r.constructor.call(r)||r,r&&this._setObjectType(r,i)),r}},registerUniqueObjectWithDataIdentifier:{value:function(e,t){e&&t&&this.isRootService&&this.isUniquing&&(this.recordDataIdentifierForObject(t,e),this.recordObjectForDataIdentifier(e,t))}},createdDataObjects:{get:function(){return this.isRootService?(this._createdDataObjects||(this._createdDataObjects=new p),this._createdDataObjects):this.rootService.createdDataObjects}},changedDataObjects:{get:function(){return this.isRootService?(this._changedDataObjects=this._changedDataObjects||new p,this._changedDataObjects):this.rootService.changedDataObjects()}},_changedDataObjects:{value:void 0},fetchData:{value:function(e,t,i){var r=this,n=!(e instanceof s),o=n&&e,a=t instanceof l?void 0:t,u=o?s.withTypeAndCriteria(o,a):e,c=t instanceof l?t:i;return u.type=this._objectDescriptorForType(u.type),c=c||new l,c.query=u,c.dataExpression=u.selectExpression,this._dataServiceByDataStream.set(c,this._childServiceRegistrationPromise.then(function(){var e;if(r.parentService&&r.parentService.childServiceForType(u.type)===r&&"function"==typeof r.fetchRawData)e=r,e._fetchRawData(c);else try{if(e=r.childServiceForType(u.type),!e)throw new Error("Can't fetch data of unknown type - "+(u.type.typeName||u.type.name)+"/"+u.type.uuid);c=e.fetchData(u,c)||c,r._dataServiceByDataStream.set(c,e)}catch(t){c.dataError(t)}return e})),c}},_fetchRawData:{value:function(e){var i=this,r=this._childServiceForQuery(e.query);r?r._fetchRawData(e):(this.authorizationPolicy===o.ON_DEMAND&&"function"==typeof this.shouldAuthorizeForQuery&&this.shouldAuthorizeForQuery(e.query)&&!this.authorization&&(this.authorizationPromise=t.DataService.authorizationManager.authorizeService(this).then(function(e){return i.authorization=e,e})["catch"](function(e){console.log(e)})),this.authorizationPromise.then(function(t){var r=e.query;e.query=i.mapSelectorToRawDataQuery(r),i.fetchRawData(e),e.query=r}))}},_childServiceForQuery:{value:function(e){var t=this._serviceIdentifierForQuery(e),i=t&&this._childServicesByIdentifier.get(t);return!i&&this._childServicesByType.has(e.type)&&(i=this._childServicesByType.get(e.type),i=i&&i[0]),i||null}},_serviceIdentifierForQuery:{value:function(e){var t,i,r=e.criteria.parameters,n=r&&r.serviceIdentifier;return n||(t=this.mappingWithType(e.type),i=t&&r&&r.propertyName,n=i&&t.serviceIdentifierForProperty(i)),n}},__dataServiceByDataStream:{value:null},_dataServiceByDataStream:{get:function(){return this.__dataServiceByDataStream||(this.__dataServiceByDataStream=new v)}},dataServiceForDataStream:{get:function(e){return this._dataServiceByDataStream.get(e)}},cancelDataStream:{value:function(e,t){if(e){var i=this._dataServiceByDataStream.get(e),r=this;h.is(i)?i.then(function(i){r._cancelServiceDataStream(i,e,t)}):this._cancelServiceDataStream(i,e,t)}}},_cancelServiceDataStream:{value:function(e,t,i){e.cancelRawDataStream(t,i),this._dataServiceByDataStream["delete"](t)}},deleteDataObject:{value:function(e){var t=!this.createdDataObjects.has(e);return this._updateDataObject(e,t&&"deleteDataObject")}},saveDataObject:{value:function(e){var t,i,r=this,n=this.nullPromise;if(this.parentService&&this.parentService._getChildServiceForObject(e)===this){var o={};return i=this._mapObjectToRawData(e,o),i||(i=this.nullPromise),i.then(function(){return r.saveRawData(o,e).then(function(){return r.rootService.createdDataObjects["delete"](e),null})})}return t=this._getChildServiceForObject(e),t?t.saveDataObject(e):n}},_updateDataObject:{value:function(e,t){var i,r=this,n=this.nullPromise;if(this.parentService&&this.parentService._getChildServiceForObject(e)===this)i=t&&this;else if(i=t&&this._getChildServiceForObject(e))return i._updateDataObject(e,t);return t?i&&(n=i[t](e).then(function(){return r.createdDataObjects["delete"](e),null})):r.createdDataObjects["delete"](e),n}},_saveDataObject:{value:function(e){var t={};return this._mapObjectToRawData(e,t),this.saveRawData(t,e)}},_initializeOffline:{value:function(){var e=this;"function"!=typeof global.addEventListener||t.DataService.prototype._isOfflineInitialized||(t.DataService.prototype._isOfflineInitialized=!0,global.addEventListener("online",function(t){e.rootService.isOffline=!1}),global.addEventListener("offline",function(t){e.rootService.isOffline=!0}))}},_isOfflineInitialized:{value:!1},isOffline:{get:function(){return void 0===this._isOffline&&(this.isOffline=!navigator.onLine),this._isOffline},set:function(e){var t=this;null===this._willBeOffline?(this._isOffline=!!e,this._willBeOffline=void 0):void 0!==this._willBeOffline?this._willBeOffline=!!e:this._isOffline===!1?this._isOffline=!!e:e||(this._isOffline=!0,this._willBeOffline=!1,this._goOnline().then(function(){var e=t._willBeOffline;return t._willBeOffline=null,t.isOffline=e,null}))}},_isOffline:{value:!1},_willBeOffline:{value:void 0},_goOnline:{value:function(){var e=this;return this.readOfflineOperations().then(function(t){return t.sort(this._compareOfflineOperations),e.performOfflineOperations(t)})["catch"](function(e){console.error(e)})}},_compareOfflineOperations:{value:function(e,t){return e.lastModified<t.lastModified?-1:e.lastModified>t.lastModified?1:e.time<t.time?-1:e.time>t.time?1:e.index<t.index?-1:e.index>t.index?1:0}},readOfflineOperations:{value:function(){var e,t,i=this,r=new v,n=this._offlineOperationServices;return this.childServices.forEach(function(o){var a=o.readOfflineOperations(r);a!==i.emptyArrayPromise&&(e=e||[],t=t||[],t.push(a.then(function(t){var i,r;for(i=0,r=t&&t.length;i<r;i+=1)n.set(t[i],o),e.push(t[i]);return null})))}),t?h.all(t).then(function(){return e}):this.emptyArrayPromise}},_offlineOperationServices:{get:function(){return this.__offlineOperationServices||(this.__offlineOperationServices=new v),this.__offlineOperationServices}},__offlineOperationServices:{value:void 0},performOfflineOperations:{value:function(e){var t,i,r,n,o,a,s=this._offlineOperationServices,l=this.nullPromise;for(i=0,n=e.length;i<n;i=r){for(t=s.get(e[i]),r=i+1;r<n&&t&&(a=s.get(o=e[r]))===t;)++r;l=this._performOfflineOperationsBatch(l,t,e,i,r)}return l}},_performOfflineOperationsBatch:{value:function(e,t,i,r,n){var o=this;return e.then(function(){return t?t.performOfflineOperations(i.slice(r,n)):o._performAndDeleteOfflineOperation(i[r])})}},_performAndDeleteOfflineOperation:{value:function(e){var t,i,r,n,o,a,s=this,l=e.type;for(this.offlineService&&(t=this.offlineService.schema[l],i=t.foreignKeys),i||(i=t._computedForeignKeys||(t._computedForeignKeys=Object.keys(e.changes))),r=0,n=i.length;r<n;r++)a=i[r],(o=this.onlinePrimaryKeyForOfflinePrimaryKey(e.changes[a]))&&(e.changes[a]=o);return this._performTypedOfflineOperation(e).then(function(){return s.deleteOfflineOperations([e])})}},_performTypedOfflineOperation:{value:function(e){var t=e.dataType||e.type,i=t&&this[this._getOfflineOperationMethodName(t)];return"function"==typeof i?i.call(this,e):this.performOfflineOperation(e)}},_getOfflineOperationMethodName:{value:function(e){var t="string"==typeof e,i=t&&this._offlineOperationMethodNames.get(e);return t&&!i&&(i="perform",i+=e[0].toUpperCase(),i+=e.slice(1),i+="OfflineOperation",this._offlineOperationMethodNames.set(e,i)),i}},_offlineOperationMethodNames:{value:new c},performOfflineOperation:{value:function(e){return this.nullPromise}},onlinePrimaryKeyForOfflinePrimaryKey:{value:function(e){return this.offlineService?this.offlineService.onlinePrimaryKeyForOfflinePrimaryKey(e):null}},deleteOfflineOperations:{value:function(e){return this.nullPromise}},nullFunction:{value:function(){return null}},nullPromise:{get:function(){return t.DataService._nullPromise||(t.DataService._nullPromise=h.resolve(null)),t.DataService._nullPromise}},_nullPromise:{value:void 0},emptyArrayPromise:{get:function(){return t.DataService._emptyArrayPromise||(t.DataService._emptyArrayPromise=h.resolve([])),t.DataService._emptyArrayPromise}},_emptyArrayPromise:{value:void 0},eventLoopPromise:{get:function(){var e=this;return this._eventLoopPromise||(this._eventLoopPromise=new h(function(t,i){setTimeout(function(){e._eventLoopPromise=void 0,t()},0)})),this._eventLoopPromise}},spliceWithArray:{value:function(e,t,i,r){return i=i||0,r=r||0===r?r:1/0,t?e.splice.apply(e,[i,r].concat(t)):e.splice(i,r)}}},{mainService:{get:function(){return this._mainService&&this._mainService.parentService&&(this._mainService=this._mainService.rootService),this._mainService},set:function(e){this._mainService=e}},AuthorizationPolicyType:{value:m},AuthorizationPolicy:{value:o},authorizationManager:{value:n}})}}),montageDefine("b7b5e36","composer/translate-composer",{dependencies:["./composer","../core/event/event-manager"],factory:function(e,t,i){var r=e("./composer").Composer,n=e("../core/event/event-manager").defaultEventManager,o=t.TranslateComposer=r.specialize({_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},_MOUSE_POINTER:{value:"mouse",writable:!1},_TOUCH_POINTER:{value:"touch",writable:!1},CLAIM_POINTER_POLICIES:{value:{DEFAULT:"default",MOVE:"move"}},enabled:{value:!0},_externalUpdate:{value:!0},isAnimating:{value:!1},isMoving:{value:!1},frame:{value:function(){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},allowTranslateOuterExtreme:{value:!1},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if("vertical"===this._axis)this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateX&&t<this._minTranslateX&&(t=this._minTranslateX),null!==this._maxTranslateX&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if("horizontal"===this._axis)this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateY&&t<this._minTranslateY&&(t=this._minTranslateY),null!==this._maxTranslateY&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateX!==e&&(null!==e&&this._translateX<e&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateX!==e&&(null!==e&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateY!==e&&(null!==e&&this._translateY<e&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateY!==e&&(null!==e&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=!!e}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,this.__momentumDuration<1&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_observedPointer:{value:null},eventManager:{get:function(){return n}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:8},_listenToWheelEvent:{value:!1},listenToWheelEvent:{set:function(e){e=!!e,this._listenToWheelEvent!==e&&(this._listenToWheelEvent=e,this._isLoaded&&(e?this._addWheelEventListener():this._removeWheelEventListener()))},get:function(){return this._listenToWheelEvent}},_claimPointerPolicy:{value:null},load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._addWheelEventListener(),this.eventManager.isStoringPointerEvents=!0}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._removeWheelEventListener()}},surrenderPointer:{value:function(e,t){var i=this.callDelegateMethod("surrenderPointer",e,t);return("undefined"==typeof i||i!==!1)&&(this._cancel(),!0)}},addEventListener:{value:function(e,t,i){r.prototype.addEventListener.call(this,e,t,i),"translate"===e&&(this._shouldDispatchTranslate=!0)}},capturePointerdown:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousedown(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchstart(e)}},capturePointermove:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousemove(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchmove(e)}},handlePointerup:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.handleMouseup(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchend(e)}},handlePointercancel:{value:function(e){(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureMousedown:{value:function(e){this.enabled&&0===e.button&&(this._observedPointer=this._MOUSE_POINTER,this._start(e.clientX,e.clientY,e.target,e.timeStamp))}},captureMousemove:{value:function(e){this.enabled&&this._handleMove(e)}},handleMouseup:{value:function(e){this.enabled&&this._end(e)}},captureTouchstart:{value:function(e){if(this.enabled&&null===this._observedPointer)if(void 0!==e.pointerId)this._observedPointer=e.pointerId,this._start(e.clientX,e.clientY,e.target,e.timeStamp),this._preventDefaultIfNeeded(e);else{var t=e.targetTouches;if(t&&1===t.length){var i=t[0];this._preventDefaultIfNeeded(e),this._observedPointer=i.identifier,this._start(i.clientX,i.clientY,i.target,e.timeStamp)}}}},captureTouchmove:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._handleMove(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._handleMove(e,t)}}},handleTouchend:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._end(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._end(t)}}},handleTouchcancel:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._cancel(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._cancel(t)}}},captureScroll:{value:function(e){e.target.contains(this.element)&&this._cancel(e)}},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&this._NATIVE_ELEMENTS.indexOf(e.target.tagName)===-1&&!e.target.isContentEditable}},_preventDefaultIfNeeded:{value:function(e){!e.defaultPrevented&&this._shouldPreventDefault(e)&&e.preventDefault()}},_addWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this._element.addEventListener(e,this,!1),this._element.addEventListener(e,this,!0)}}},_removeWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";
this._element.removeEventListener(e,this,!1),this._element.removeEventListener(e,this,!0)}}},_start:{value:function(e,t,i,r){this.pointerStartEventPosition={pageX:e,pageY:t,target:i,timeStamp:r},this._pointerX=e,this._pointerY=t,window.PointerEvent?(this._element.addEventListener("pointerdown",this,!1),document.addEventListener("pointermove",this,!0),document.addEventListener("pointerup",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.addEventListener("MSPointerDown",this,!1),document.addEventListener("MSPointerMove",this,!0),document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.addEventListener("mousedown",this,!1),document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!1)):(this._element.addEventListener("touchstart",this,!1),this._element.addEventListener("touchmove",this,!0),this._element.addEventListener("touchend",this,!1),this._element.addEventListener("touchcancel",this,!1)),document.addEventListener("scroll",this,!0),this.isAnimating&&(this.isAnimating=!1,this._dispatchTranslateEnd()),this._isFirstMove=!0}},_handleStart:{value:function(e){this._claimPointerPolicy=this.eventManager.componentClaimingPointer(this._observedPointer)?this.CLAIM_POINTER_POLICIES.MOVE:this.CLAIM_POINTER_POLICIES.DEFAULT}},_findObservedTouch:{value:function(e){for(var t,i=null,r=0;(t=e[r])&&null===i;r++)t.identifier===this._observedPointer&&(i=t);return i}},_handleMove:{value:function(e,t){var i=this.eventManager,n=this.pointerStartEventPosition;if(t||(t=e),this._isFirstMove){var o=i.componentClaimingPointer(this._observedPointer);if(o){var a=!0;if(this._claimPointerPolicy===this.CLAIM_POINTER_POLICIES.MOVE){var s=this._observedPointer===this._MOUSE_POINTER?this._mouseRadiusThreshold:this._touchRadiusThreshold,l=n.pageX-t.clientX,u=n.pageY-t.clientY;a=r.isCoordinateOutsideRadius(l,u,s),a&&(n.pageX=t.clientX,n.pageY=t.clientY,n.target=t.target,n.timeStamp=e.timeStamp,this._pointerX=t.clientX,this._pointerY=t.clientY)}if(!a)return void this._preventDefaultIfNeeded(e)}i.claimPointer(this._observedPointer,this)}i.isPointerClaimedByComponent(this._observedPointer,this)?(this._preventDefaultIfNeeded(e),(this.allowTranslateOuterExtreme||this._shouldMove(e,t.clientX,t.clientY))&&(this._isFirstMove?this._firstMove():this._move(t.clientX,t.clientY))):this._releaseInterest()}},_shouldMove:{value:function(e,t,i){var r,n,o,a,s=this._translateY,l=this._translateX,u=this._minTranslateY,c=this._maxTranslateY,h=this._minTranslateX,d=this._maxTranslateX,p=!0;return"wheel"===e.type||"mousewheel"===e.type?("vertical"!==this._axis&&(o=20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this._axis&&(a=20*(e.wheelDeltaY||-e.deltaY||0)/120),p=!("horizontal"===this._axis&&0===o||"vertical"===this._axis&&0===a||0===o&&0===a)):("vertical"!==this._axis&&(o=-(this._invertXAxis?this._pointerX-t:t-this._pointerX)),"horizontal"!==this._axis&&(a=-(this._invertYAxis?this._pointerY-i:i-this._pointerY))),p&&(a&&(r=this._isNegativeNumber(a),null!==u&&(p=s!==u||s===u&&r),null!==c&&p&&(p=s!==c||s===c&&!r)),o&&(n=this._isNegativeNumber(o),null!==h&&p&&(p=l!==h||l===h&&n),null!==d&&p&&(p=l!==d||l===d&&!n))),p}},_firstMove:{value:function(){this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1,this.isMoving=!0)}},_move:{value:function(e,t){var i;this._isSelfUpdate=!0,"vertical"!==this._axis&&(i=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=i*this._pointerSpeedMultiplier),"horizontal"!==this._axis&&(i=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=i*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX||this.translateStrideY)?("vertical"!==this._axis?this.momentumX=t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):this.momentumX=0,"horizontal"!==this._axis?this.momentumY=t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):this.momentumY=0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateEnd()),this._releaseInterest()}},_cancel:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this.animateMomentum=!1,this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateCancel()),this._releaseInterest()}},_releaseInterest:{value:function(){window.PointerEvent?(this._element.removeEventListener("pointerdown",this,!1),document.removeEventListener("pointermove",this,!0),document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.removeEventListener("MSPointerDown",this,!1),document.removeEventListener("MSPointerMove",this,!0),document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.removeEventListener("mousedown",this,!1),document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!1)):(this._element.removeEventListener("touchstart",this,!1),this._element.removeEventListener("touchmove",this,!0),this._element.removeEventListener("touchend",this,!1),this._element.removeEventListener("touchcancel",this,!1)),document.removeEventListener("scroll",this,!0),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._isFirstMove=!1,this.isMoving=!1}},_isAxisMovement:{value:function(e){var t,i,r,n,o,a,s,l=e.velocity,u=.7853981633974483,c=2.356194490192345,h=-2.356194490192345,d=-.7853981633974483;if("both"===this.axis)return!0;if(!l||0===l.speed||isNaN(l.speed)?(a=this.pointerStartEventPosition.pageX-e.clientX,s=this.pointerStartEventPosition.pageY-e.clientY,o=Math.atan2(s,a)):o=l.angle,"horizontal"===this.axis){if(r=o<=u&&o>=d,n=o>=c||o<=h,r||n)return!0}else if("vertical"===this.axis&&(t=o<=d&&o>=h,i=o>=u&&o<=c,t||i))return!0;return!1}},_translateEndTimeout:{value:null},_handleWheelTimeout:{value:null},_isNegativeNumber:{value:function(e){return e=+e,isNaN(e)||(e=1/e),e<0}},captureWheel:{value:function(e){this._shouldMove(e)?this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)||this.eventManager.claimPointer(this._WHEEL_POINTER,this):this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)}},handleWheel:{value:function(e){if(this.enabled&&this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)){if(this._observedPointer=this._WHEEL_POINTER,this._translateEndTimeout?clearTimeout(this._translateEndTimeout):this._dispatchTranslateStart(),"vertical"!==this.axis&&(this.translateX=this._translateX-20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this.axis&&(this.translateY=this._translateY-20*(e.wheelDeltaY||-e.deltaY||0)/120),this.isMoving=!0,this._dispatchTranslate(),"function"!=typeof this._handleWheelTimeout){var t=function(){this._translateEndTimeout=null,this._dispatchTranslateEnd(),this.isMoving=!1,this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)};this._handleWheelTimeout=t.bind(this)}this._translateEndTimeout=setTimeout(this._handleWheelTimeout,400),e.preventDefault()}}},_bezierTValue:{value:function(e,t,i,r,n){var o,a,s,l,u=1-3*r+3*t,c=3*r-6*t,h=3*t,d=.5;for(a=0;a<10;a++)l=d*d,o=3*u*l+2*c*d+h,s=1-d,d-=(3*(s*s*d*t+s*l*r)+l*d-e)/o;return l=d*d,s=1-d,3*(s*s*d*i+s*l*n)+l*d}},_dispatchTranslateStart:{value:function(e,t){var i=document.createEvent("CustomEvent");i.initCustomEvent("translateStart",!0,!0,null),i.translateX=e,i.translateY=t,i.scroll=0,i.pointer=this._observedPointer,this.dispatchEvent(i)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e,t,i,r,n=Date.now(),o=!1;this.animateMomentum&&(e=n-this.startTime,e<this.__momentumDuration?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posX-this.endX)<.75*this.translateStrideX)&&(this.startStrideXTime=n),this.translateStrideY&&null===this.startStrideYTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posY-this.endY)<.75*this.translateStrideY)&&(this.startStrideYTime=n)):this.animateMomentum=!1),t=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&n-this.startStrideXTime>0&&(n-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((n-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-e)+t*this.translateStrideX*e,o=!0):this.posX=t*this.translateStrideX),t=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&n-this.startStrideYTime>0&&(n-this.startStrideYTime<this.translateStrideDuration?(e=this._bezierTValue((n-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-e)+t*this.translateStrideY*e,o=!0):this.posY=t*this.translateStrideY),i=this.posX,r=this.posY,this._isSelfUpdate=!0,this.translateX=i,this.translateY=r,this._shouldDispatchTranslate&&this._dispatchTranslate(),this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||o,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()}}});o.prototype.captureMSPointerDown=o.prototype.capturePointerdown,o.prototype.captureMSPointerMove=o.prototype.capturePointermove,o.prototype.handleMSPointerUp=o.prototype.handlePointerup,o.prototype.handleMSPointerCancel=o.prototype.handlePointercancel,o.prototype.handleMousewheel=o.prototype.handleWheel,o.prototype.handleMSPointerDown=o.prototype._handleStart,o.prototype.handlePointerdown=o.prototype._handleStart,o.prototype.handleMousedown=o.prototype._handleStart,o.prototype.handleTouchstart=o.prototype._handleStart,void 0!==Math.sign&&(o.prototype._isNegativeNumber=function(e){return Math.sign(e)===-1})}}),montageDefine("b7b5e36","composer/press-composer",{dependencies:["../core/core","./composer","../core/event/mutable-event"],factory:function(e,t,i){var r=e("../core/core").Montage,n=e("./composer").Composer,o=e("../core/event/mutable-event").MutableEvent,a=function(){function e(e){return{get:function(){return this._event[e]}}}function t(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}}var i=o.specialize({type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}});return["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"].forEach(function(t){r.defineProperty(i,t,e(t))}),["clientX","clientY","pageX","pageY","screenX","screenY","target"].forEach(function(e){r.defineProperty(i,e,t(e))}),i}(),s=t.PressComposer=n.specialize({load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0))}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0))}},delegate:{value:null},cancelPress:{value:function(){return this._state===s.PRESSED&&(this._cancelPress(),!0)}},_cancelPress:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},addEventListener:{value:function(e,t,i){n.prototype.addEventListener.call(this,e,t,i),"longPress"===e&&(this._shouldDispatchLongPress=!0)}},_state:{value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{value:!1},_longPressThreshold:{value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_needDispatchSafePress:{value:!1},_longPressTimeout:{value:null},_observedPointer:{value:null},_initialCenterPositionX:{value:0},_initialCenterPositionY:{value:0},_shouldSaveInitialCenterPosition:{value:!1},_targetElementOnLastTouchMove:{value:null},_endInteraction:{value:function(){this._element&&(this._removeEventListeners(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._targetElementOnLastTouchMove=null,this._state=s.UNPRESSED,this._initialCenterPositionX=0,this._initialCenterPositionY=0,this._shouldSaveInitialCenterPosition=!1)}},_changedTouchisObserved:{value:function(e){if(null===this._observedPointer)return!1;for(var t=0,i=e.length;t<i;t++)if(e[t].identifier===this._observedPointer)return t;return!1}},surrenderPointer:{value:function(e,t){var i=this.callDelegateMethod("shouldComposerSurrenderPointerToComponent",this,e,t);return("undefined"==typeof i||i!==!1)&&(this.cancelPress(),!0)}},_shouldPerformPress:{value:function(){return!(this.component.disabled||null!==this._observedPointer)}},capturePointerdown:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.captureTouchstart(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.captureMousedown(e)}},handlePointerup:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.handleTouchend(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.handleMouseup(e)}},handlePointercancel:{value:function(e){("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureTouchstart:{value:function(e){this._shouldPerformPress()&&(void 0!==e.pointerId?this._observedPointer=e.pointerId:e.changedTouches&&1===e.changedTouches.length&&(this._observedPointer=e.changedTouches[0].identifier),null!==this._observedPointer&&this.component.eventManager.claimPointer(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},handleTouchend:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);var t;e.pointerId===this._observedPointer?t=e.target:this._changedTouchisObserved(e.changedTouches)!==!1&&(t=this._targetElementOnLastTouchMove||e.target),t&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&(this.element===t||this.element.contains(t)?this._dispatchPress(e,"undefined"==typeof e.pointerId?t:null):this._dispatchPressCancel(e),this._endInteraction(e))}},_saveInitialCenterPositionIfNeeded:{value:function(){this._shouldSaveInitialCenterPosition&&(this._saveInitialCenterPosition(),this._shouldSaveInitialCenterPosition=!1)}},_cancelPressIfCenterPositionChange:{value:function(e){return this._saveInitialCenterPositionIfNeeded(),!!this._isPositionChanged(e)&&(this._cancelPress(e),!0)}},_handleMove:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this._needDispatchSafePress=!1,("mouse"===this._observedPointer||e.pointerId===this._observedPointer||e.changedTouches&&this._changedTouchisObserved(e.changedTouches)!==!1)&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&!this._cancelPressIfCenterPositionChange(e)&&"touchmove"===e.type){var t=e.changedTouches[0];this._targetElementOnLastTouchMove=document.elementFromPoint(t.clientX,t.clientY)}}},captureWheel:{value:function(e){return null===this._observedPointer?void this._endInteraction(e):void((e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e))}},handleTouchcancel:{value:function(e){null!==this._observedPointer&&e.pointerId!==this._observedPointer&&this._changedTouchisObserved(e.changedTouches)===!1||(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e))}},captureMousedown:{value:function(e){0===e.button&&this._shouldPerformPress()&&(this._observedPointer="mouse",this.component.eventManager.claimPointer(this._observedPointer,this),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},_handlePointerDown:{value:function(e){if(this._removePointerDownListener(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){if(this._needDispatchSafePress=!1,"touchstart"===e.type){var t=this;window.nativeAddEventListener("touchstart",function i(e){window.nativeRemoveEventListener("touchstart",i,!1),t._needDispatchSafePress=!e.defaultPrevented},!1)}this._shouldSaveInitialCenterPosition=!0,this._addEventListeners(),this._dispatchPressStart(e)}else this._observedPointer=null}},captureScroll:{value:function(e){(e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e)}},handleMouseup:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){for(var t=e.target;t!==this._element&&t&&t.parentNode;)t=t.parentNode;if(t===this._element)return this._dispatchPress(e),void this._endInteraction(e)}this._cancelPress(e)}},handleDragstart:{value:function(e){this._cancelPress(e)}},_saveInitialCenterPosition:{value:function(){if(this.element instanceof HTMLElement){var e=this.element.getBoundingClientRect();this._initialCenterPositionX=e.left+e.width/2,this._initialCenterPositionY=e.top+e.height/2}}},_isPositionChanged:{value:function(e){if(this.element instanceof HTMLElement){var t=this.element.getBoundingClientRect(),i=t.left+t.width/2,r=t.top+t.height/2;if(this._initialCenterPositionX!==i||this._initialCenterPositionY!==r){var o=e.type,a=Math.abs(this._initialCenterPositionX-i),s=Math.abs(this._initialCenterPositionY-r),l="mouse"===this._observedPointer||"wheel"===o||"mousewheel"===o||"scroll"===o?this._mouseRadiusThreshold:this._touchRadiusThreshold;return n.isCoordinateOutsideRadius(a,s,l)}}return!1}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:4},_addPointerDownListener:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.addEventListener("mousedown",this,!1):this._element.addEventListener("touchstart",this,!1)}},_removePointerDownListener:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.removeEventListener("mousedown",this,!1):this._element.removeEventListener("touchstart",this,!1)}},_addEventListeners:{value:function(){window.PointerEvent?(this.shawdowRoot&&(this.shawdowRoot.addEventListener("pointerup",this,!1),this.shawdowRoot.addEventListener("pointermove",this,!1),this.shawdowRoot.addEventListener("pointercancel",this,!1)),document.addEventListener("pointerup",this,!1),document.addEventListener("pointermove",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this.shawdowRoot&&(this.shawdowRoot.addEventListener("MSPointerUp",this,!1),this.shawdowRoot.addEventListener("MSPointerMove",this,!1),this.shawdowRoot.addEventListener("MSPointerCancel",this,!1)),document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerMove",this,!1),document.addEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(this.shawdowRoot&&(this.shawdowRoot.addEventListener("mouseup",this,!1),this.shawdowRoot.addEventListener("mousemove",this,!1),this.shawdowRoot.addEventListener("dragstart",this,!1)),document.addEventListener("mouseup",this,!1),document.addEventListener("mousemove",this,!1),this._element.addEventListener("dragstart",this,!1)):(this.shawdowRoot&&(this.shawdowRoot.addEventListener("touchend",this,!1),this.shawdowRoot.addEventListener("touchcancel",this,!1),this.shawdowRoot.addEventListener("touchmove",this,!1)),document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1),document.addEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this.shawdowRoot&&(this.shawdowRoot.addEventListener(e,this,!0),this.shawdowRoot.addEventListener("scroll",this,!0)),document.addEventListener(e,this,!0),document.addEventListener("scroll",this,!0)}},_removeEventListeners:{value:function(){window.PointerEvent?(this.shawdowRoot&&(this.shawdowRoot.removeEventListener("pointerup",this,!1),this.shawdowRoot.removeEventListener("pointermove",this,!1),this.shawdowRoot.removeEventListener("pointercancel",this,!1)),document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointermove",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this.shawdowRoot&&(this.shawdowRoot.removeEventListener("MSPointerUp",this,!1),this.shawdowRoot.removeEventListener("MSPointerMove",this,!1),this.shawdowRoot.removeEventListener("MSPointerCancel",this,!1)),document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerMove",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(this.shawdowRoot&&(this.shawdowRoot.removeEventListener("mouseup",this,!1),this.shawdowRoot.removeEventListener("mousemove",this,!1),this.shawdowRoot.removeEventListener("dragstart",this,!1)),document.removeEventListener("mouseup",this,!1),document.removeEventListener("mousemove",this,!1),this._element.removeEventListener("dragstart",this,!1)):(this.shawdowRoot&&(this.shawdowRoot.removeEventListener("touchend",this,!1),this.shawdowRoot.removeEventListener("touchcancel",this,!1),this.shawdowRoot.removeEventListener("touchmove",this,!1)),document.removeEventListener("touchend",this,!1),document.removeEventListener("touchcancel",this,!1),document.removeEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this.shawdowRoot&&(this.shawdowRoot.removeEventListener(e,this,!0),this.shawdowRoot.removeEventListener("scroll",this,!0)),document.removeEventListener(e,this,!0),document.removeEventListener("scroll",this,!0)}},_createPressEvent:{enumerable:!1,value:function(e,t){var i,r,n=t;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),i=new a,i.event=t,i.type=e,i.pointer=this._observedPointer,i.targetElement=t.target,t.changedTouches&&(r=this._changedTouchisObserved(t.changedTouches))!==!1&&(n=i.touch=t.changedTouches[r]),n&&(i.clientX=n.clientX,i.clientY=n.clientY,i.pageX=n.pageX,i.pageY=n.pageY),i}},_dispatchPressStart:{enumerable:!1,value:function(e){if(this._state=s.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e)),this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress(e.target)},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e,t){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null);var i=this._createPressEvent("press",e);if(t&&(i.targetElement=t,this._needDispatchSafePress||e.defaultPrevented)){var r=this,n=document.defaultView.defaultEventManager,o=function(a){(t===a.target||n._couldEmulatedEventHaveWrongTarget(e.changedTouches[0],a,n._emulatedEventRadiusThreshold,n._emulatedEventTimestampThreshold))&&r._dispatchSafePress(i,o)};return window.nativeAddEventListener("mousedown",o,!0),void(o.timeoutID=setTimeout(function(){r._dispatchSafePress(i,o)},300))}this.dispatchEvent(i),this._state=s.UNPRESSED}},_dispatchSafePress:{value:function(e,t){clearTimeout(t.timeoutID),t.timeoutID=null,window.nativeRemoveEventListener("mousedown",t,!0),this.dispatchEvent(e),this._state=s.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){var t;this._shouldDispatchLongPress&&(t=this._createPressEvent("longPress"),t.targetElement=e,this.dispatchEvent(t),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=s.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))}}},{UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2}});s.prototype.captureMSPointerDown=s.prototype.capturePointerdown,s.prototype.handleMSPointerUp=s.prototype.handlePointerup,s.prototype.handleMSPointerCancel=s.prototype.handlePointercancel,s.prototype.handleMSPointerMove=s.prototype._handleMove,s.prototype.handlePointermove=s.prototype._handleMove,s.prototype.handleTouchmove=s.prototype._handleMove,s.prototype.handleMousemove=s.prototype._handleMove,s.prototype.handleMousewheel=s.prototype.handleWheel,s.prototype.handleMSPointerDown=s.prototype._handlePointerDown,s.prototype.handlePointerdown=s.prototype._handlePointerDown,s.prototype.handleMousedown=s.prototype._handlePointerDown,s.prototype.handleTouchstart=s.prototype._handlePointerDown}}),montageDefine("b7b5e36","core/meta/object-descriptor",{dependencies:["../core","./derived-descriptor","./event-descriptor","./model","../promise","./property-descriptor","./validation-rule","../deprecate","../core","../core","../core","../core"],factory:function(e,t,i){var r=e("../core").Montage,n=e("./derived-descriptor").DerivedDescriptor,o=e("./event-descriptor").EventDescriptor,a=e("./model"),s=e("../promise").Promise,l=e("./property-descriptor").PropertyDescriptor,u=e("./validation-rule").PropertyValidationRule,c=e("../deprecate"),h={name:"default",customPrototype:!1},d=t.ObjectDescriptor=r.specialize({FileExtension:{value:".mjson"},constructor:{value:function(){this._eventDescriptors=[],this._propertyDescriptors=[],this.addRangeAtPathChangeListener("_propertyDescriptors",this,"_handlePropertyDescriptorsRangeChange"),this._propertyDescriptorGroups={},Object.defineProperty(this,"_propertyDescriptorsTable",{value:{},writable:!1}),Object.defineProperty(this,"_eventPropertyDescriptorsTable",{value:{},writable:!1}),this.defineBinding("eventDescriptors",{"<-":"_eventDescriptors.concat(parent.eventDescriptors)"})}},initWithName:{value:function(e){return this._name=null!==e?e:"default",this.customPrototype=!1,this}},serializeSelf:{value:function(e){e.setProperty("name",this.name),this._model&&!this.model.isDefault&&e.setProperty("model",this._model,"reference"),this.objectDescriptorInstanceModule&&e.setProperty("objectDescriptorModule",this.objectDescriptorInstanceModule),this._parent&&e.setProperty("parent",this._parent),this._setPropertyWithDefaults(e,"customPrototype",this.customPrototype),this._propertyDescriptors.length>0&&e.setProperty("propertyDescriptors",this._propertyDescriptors),Object.getOwnPropertyNames(this._propertyDescriptorGroups).length>0&&e.setProperty("propertyDescriptorGroups",this._propertyDescriptorGroups),this._eventDescriptors.length>0&&e.setProperty("eventDescriptors",this._eventDescriptors),this._propertyValidationRules.length>0&&e.setProperty("propertyValidationRules",this._propertyValidationRules),"number"==typeof this.maxAge&&e.setProperty("maxAge",this.maxAge)}},deserializeSelf:{value:function(e){var t,i;t=e.getProperty("name"),void 0!==t&&(this._name=t),t=e.getProperty("model")||e.getProperty("binder"),t&&(this._model=t),t=e.getProperty("objectDescriptorModule")||e.getProperty("blueprintModule"),void 0!==t&&(this.objectDescriptorInstanceModule=t),i=e.getProperty("parent"),i&&(i.promise&&i.valueFromReference?(c.deprecationWarningOnce("parent reference via ObjectDescriptorReference","direct reference with object syntax"),this._parentReference=i):this._parent=i),this.customPrototype=this._getPropertyWithDefaults(e,"customPrototype"),t=e.getProperty("propertyDescriptors")||e.getProperty("propertyBlueprints"),t&&(this._propertyDescriptors=t),t=e.getProperty("propertyDescriptorGroups")||e.getProperty("propertyBlueprintGroups"),t&&(this._propertyDescriptorGroups=t),t=e.getProperty("eventDescriptors")||e.getProperty("eventBlueprints"),t&&(this._eventDescriptors=t),t=e.getProperty("propertyValidationRules"),t&&(this._propertyValidationRules=t),t=e.getProperty("maxAge"),t&&(this.maxAge=t)}},_setPropertyWithDefaults:{value:function(e,t,i){i!==h[t]&&e.setProperty(t,i)}},_getPropertyWithDefaults:{value:function(e,t){var i=e.getProperty(t);return i||this[t]||h[t]}},_name:{value:null},name:{get:function(){return this._name}},create:{value:function(e,t,i){var r;if("undefined"==typeof e||d.prototype.isPrototypeOf(e)){var n=Object.getPrototypeOf(d).create;return n.call(this,"undefined"==typeof e?this:e,t,i)}return r="function"==typeof e.specialize||t?e.specialize(t,i):new e,this.ObjectProperty.applyWithObjectDescriptor(r.prototype,this),
this.customPrototype=!0,r}},newInstance:{value:function(){var e=this.newInstancePrototype();return e?new e:null}},newInstancePrototype:{value:function(){if(this.customPrototype)throw new Error("Already has customPrototype");var e=this.parent?this.parent.newInstancePrototype():r,t=e.specialize({init:{value:function(){return this}}});return this.ObjectProperty.applyWithObjectDescriptor(t.prototype,this),t?t:null}},ObjectProperty:{serializable:!1,enumerable:!0,get:function(){return this.model?this.model.ObjectProperty:a.Model.group.defaultObjectDescriptorObjectProperty}},objectDescriptorInstanceModule:{serializable:!1,value:null},identifier:{get:function(){return["objectDescriptor",(this.name||"unnamed").toLowerCase()].join("_")}},_model:{value:null},model:{serializable:!1,get:function(){return this._model||(this._model=a.Model.group.defaultModel,this._model.addObjectDescriptor(this)),this._model},set:function(e){this._model=e}},_parentReference:{value:null},_parent:{value:null},parent:{serializable:!1,get:function(){return this._parent},set:function(e){this._parent=e}},customPrototype:{value:!1},_propertyDescriptors:{value:null},_handlePropertyDescriptorsRangeChange:{value:function(e,t,i){var r,n;for(r=0,n=t.length;r<n;++r)t[r]._owner=null;for(r=0,n=e.length;r<n;++r)e[r]._owner=e[r]._owner||this}},propertyDescriptors:{get:function(){var e=[];return e=e.concat(this._propertyDescriptors),this.parent&&(e=e.concat(this.parent.propertyDescriptors)),e}},serializablePropertyDescriptors:{get:function(){return this.propertyDescriptors.filter(function(e){return e.serializable!==!1})}},_propertyDescriptorsTable:{value:null},addPropertyDescriptor:{value:function(e){if(null!==e&&null!==e.name){var t=this._propertyDescriptors.indexOf(e);t<0&&(null!==e.owner&&e.owner!==this&&e.owner.removePropertyDescriptor(e),this._propertyDescriptors.push(e),this._propertyDescriptorsTable[e.name]=e,e._owner=this)}return e}},removePropertyDescriptor:{value:function(e){if(null!==e&&null!==e.name){var t=this._propertyDescriptors.indexOf(e);t>=0&&(this._propertyDescriptors.splice(t,1),delete this._propertyDescriptorsTable[e.name],e._owner=null)}return e}},newPropertyDescriptor:{value:function(e,t){return(new l).initWithNameObjectDescriptorAndCardinality(e,this,t)}},addToOnePropertyDescriptorNamed:{value:function(e){return this.addPropertyDescriptor(this.newPropertyDescriptor(e,1))}},addToManyPropertyDescriptorNamed:{value:function(e){return this.addPropertyDescriptor(this.newPropertyDescriptor(e,1/0))}},addToOneAssociationBlueprintNamed:{value:function(e,t){var i=this.addPropertyDescriptor(this.addToOnePropertyDescriptorNamed(e));return t&&(i.valueDescriptor=t.owner,t.valueDescriptor=this),i}},addToManyAssociationBlueprintNamed:{value:function(e,t){var i=this.addPropertyDescriptor(this.addToManyPropertyDescriptorNamed(e));return t&&(i.valueDescriptor=t.owner,t.valueDescriptor=this),i}},propertyDescriptorForName:{value:function(e){var i=this._propertyDescriptorsTable[e];if(void 0===i){i=t.UnknownPropertyDescriptor;var r,n;for(n=0;"undefined"!=typeof(r=this._propertyDescriptors[n]);n++)if(r.name===e){i=r;break}this._propertyDescriptorsTable[e]=i}return i===t.UnknownPropertyDescriptor&&(i=null),!i&&this.parent&&(i=this.parent.propertyDescriptorForName(e)),i}},_propertyDescriptorGroups:{value:null},propertyDescriptorGroups:{get:function(){var e,t=[];for(e in this._propertyDescriptorGroups)this._propertyDescriptorGroups.hasOwnProperty(e)&&t.push(e);return this.parent&&(t=t.concat(this.parent.propertyDescriptorGroups)),t}},propertyDescriptorGroupForName:{value:function(e){var t=this._propertyDescriptorGroups[e];return!t&&this.parent&&(t=this.parent.propertyDescriptorGroupForName(e)),t}},addPropertyDescriptorGroupNamed:{value:function(e){var t=this._propertyDescriptorGroups[e];return t||(t=[],this._propertyDescriptorGroups[e]=t),t}},removePropertyDescriptorGroupNamed:{value:function(e){var t=this._propertyDescriptorGroups[e];return t||delete this._propertyDescriptorGroups[e],t}},addPropertyDescriptorToGroupNamed:{value:function(e,t){var i,r=this._propertyDescriptorGroups[t];return r||(r=this.addPropertyDescriptorGroupNamed(t)),i=r.indexOf(e),i<0&&r.push(e),r}},removePropertyDescriptorFromGroupNamed:{value:function(e,t){var i=this._propertyDescriptorGroups[t];if(i&&e){var r=i.indexOf(e);r>=0&&i.splice(r,1)}return i||[]}},_eventDescriptors:{value:null},eventDescriptors:{value:null},_eventPropertyDescriptorsTable:{value:null},addEventDescriptor:{value:function(e){if(e&&e.name){var t=this._eventDescriptors.indexOf(e);t<0&&(e.owner&&e.owner!==this&&e.owner.removeEventDescriptor(e),this._eventDescriptors.push(e),this._eventPropertyDescriptorsTable[e.name]=e,e._owner=this)}return e}},removeEventDescriptor:{value:function(e){if(e&&e.name){var t=this._eventDescriptors.indexOf(e);t>=0&&(this._eventDescriptors.splice(t,1),delete this._eventPropertyDescriptorsTable[e.name],e._owner=null)}return e}},newEventDescriptor:{value:function(e){return(new o).initWithNameAndObjectDescriptor(e,this)}},addEventDescriptorNamed:{value:function(e){return this.addEventDescriptor(this.newEventDescriptor(e))}},eventDescriptorForName:{value:function(e){var i=this._eventPropertyDescriptorsTable[e];if("undefined"==typeof i){i=t.UnknownEventDescriptor;var r,n;for(n=0;"undefined"!=typeof(r=this._eventDescriptors[n]);n++)if(r.name===e){i=r;break}this._eventPropertyDescriptorsTable[e]=i}return i===t.UnknownEventDescriptor&&(i=null),!i&&this.parent&&(i=this.parent.eventDescriptorForName(e)),i}},_propertyValidationRules:{value:{}},propertyValidationRules:{get:function(){var e,t=[];for(e in this._propertyValidationRules)this._propertyValidationRules.hasOwnProperty(e)&&t.push(this._propertyValidationRules[e]);return this.parent&&(t=t.concat(this.parent.propertyValidationRules)),t}},propertyValidationRuleForName:{value:function(e){var t=this._propertyValidationRules[e];return!t&&this.parent&&(t=this.parent.propertyValidationRuleForName(e)),t}},addPropertyValidationRule:{value:function(e){var t=this._propertyValidationRules[e];return t||(t=(new u).initWithNameAndObjectDescriptor(e,this),this._propertyValidationRules[e]=t),t}},removePropertyValidationRule:{value:function(e){var t=this._propertyValidationRules[e];return t&&delete this._propertyValidationRules[e],t}},evaluateRules:{value:function(e){var t,i,r=[];for(t in this._propertyValidationRules)this._propertyValidationRules.hasOwnProperty(t)&&(i=this._propertyValidationRules[t],i.evaluateRule(e)&&r.push(i.messageKey));return r}},objectDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,objectDescriptor:e("../core")._objectDescriptorDescriptor,addEventBlueprint:{value:c.deprecateMethod(void 0,function(e){return this.addEventDescriptor(e)},"addEventBlueprint","addEventDescriptor")},addEventBlueprintNamed:{value:c.deprecateMethod(void 0,function(e){return this.addEventDescriptorNamed(e)},"addEventBlueprintNamed","addEventDescriptorNamed")},addPropertyBlueprint:{value:c.deprecateMethod(void 0,function(e){this.addPropertyDescriptor(e)},"addPropertyBlueprint","addPropertyDescriptor")},addPropertyBlueprintGroupNamed:{value:c.deprecateMethod(void 0,function(e){this.addPropertyDescriptorGroupNamed(e)},"addPropertyBlueprintGroupNamed","addPropertyDescriptorGroupNamed")},addPropertyBlueprintToGroupNamed:{value:c.deprecateMethod(void 0,function(e,t){this.addPropertyDescriptorToGroupNamed(e,t)},"addPropertyBlueprintToGroupNamed","addPropertyDescriptorToGroupNamed")},addToOnePropertyBlueprintNamed:{value:c.deprecateMethod(void 0,function(e){return this.addToOnePropertyDescriptorNamed(e)},"addToOnePropertyBlueprintNamed","addToOnePropertyDescriptorNamed")},addToManyPropertyBlueprintNamed:{value:c.deprecateMethod(void 0,function(e){return this.addToManyPropertyDescriptorNamed(e)},"addToManyPropertyBlueprintNamed","addToManyPropertyDescriptorNamed")},blueprintInstanceModule:{serializable:!1,get:c.deprecateMethod(void 0,function(){return this.objectDescriptorInstanceModule},"blueprintInstanceModule.get","objectDescriptorInstanceModule.get"),set:c.deprecateMethod(void 0,function(e){this.objectDescriptorInstanceModule=e},"blueprintInstanceModule.set","objectDescriptorInstanceModule.set")},binder:{serializable:!1,get:c.deprecateMethod(void 0,function(){return this.model},"binder.get","model.get"),set:c.deprecateMethod(void 0,function(e){this.model=e},"binder.set","model.set")},eventBlueprintForName:{value:c.deprecateMethod(void 0,function(e){return this.eventDescriptorForName(e)},"eventBlueprintForName","eventDescriptorForName")},eventBlueprints:{get:c.deprecateMethod(void 0,function(){return this.eventDescriptors},"eventBlueprints.get","eventDescriptors.get"),set:c.deprecateMethod(void 0,function(e){this.eventDescriptors=e},"eventBlueprints.set","eventDescriptors.set")},newAssociationBlueprint:{value:function(e,t){return 1===t?this.addToOnePropertyDescriptorNamed(e):this.addToManyPropertyDescriptorNamed(e)}},newDerivedPropertyBlueprint:{value:c.deprecateMethod(void 0,function(e,t){return this.newDerivedDescriptor(e,t)},"newDerivedPropertyBlueprint","newDerivedDescriptor")},newDerivedDescriptor:{value:function(e,t){return(new n).initWithNameObjectDescriptorAndCardinality(e,this,t)}},newEventBlueprint:{value:c.deprecateMethod(void 0,function(e){return this.newEventDescriptor(e)},"newEventBlueprint","newEventDescriptor")},newPropertyBlueprint:{value:c.deprecateMethod(void 0,function(e,t){return this.newPropertyDescriptor(e,t)},"newPropertyBlueprint","newPropertyDescriptor")},propertyBlueprintForName:{value:c.deprecateMethod(void 0,function(e){return this.propertyDescriptorForName(e)},"propertyBlueprintForName","propertyDescriptorForName")},propertyBlueprintGroups:{get:c.deprecateMethod(void 0,function(){return this.propertyDescriptorGroups},"propertyBlueprintGroups","propertyDescriptorGroups")},propertyBlueprintGroupForName:{value:c.deprecateMethod(void 0,function(e){return this.propertyDescriptorGroupForName(e)},"propertyBlueprintGroupForName","propertyDescriptorForName")},propertyBlueprints:{get:c.deprecateMethod(void 0,function(){return this.propertyDescriptors},"propertyBlueprints","propertyDescriptors")},removeEventBlueprint:{value:c.deprecateMethod(void 0,function(e){this.removeEventDescriptor(e)},"removeEventBlueprint","removeEventDescriptor")},removePropertyBlueprint:{value:c.deprecateMethod(void 0,function(e){this.removePropertyDescriptor(e)},"removePropertyBlueprint","removePropertyDescriptor")},removePropertyBlueprintFromGroupNamed:{value:c.deprecateMethod(void 0,function(e,t){this.removePropertyDescriptorFromGroupNamed(e,t)},"removePropertyBlueprintFromGroupNamed","removePropertyDescriptorGroupNamed")},removePropertyBlueprintGroupNamed:{value:c.deprecateMethod(void 0,function(e){this.removePropertyDescriptorGroupNamed(e)},"removePropertyBlueprintGroupNamed","removePropertyDescriptorGroupNamed")},maxAge:{value:240},blueprintModuleId:e("../core")._objectDescriptorModuleIdDescriptor,blueprint:e("../core")._objectDescriptorDescriptor},{createDefaultBlueprintForObject:{value:c.deprecateMethod(void 0,function(e){return d.createDefaultObjectDescriptorForObject(e)},"Blueprint.createDefaultBlueprintForObject","ObjectDescriptor.createDefaultObjectDescriptorForObject")},createDefaultObjectDescriptorForObject:{value:function(e){if(e){var i=r.getInfoForObject(e).isInstance?Object.getPrototypeOf(e):e.prototype,n=r.getInfoForObject(i),o=new this;for(var a in i)if("_"!==a[0]&&i.hasOwnProperty(a)){var l,u=i[a];l=Array.isArray(u)?o.addToManyPropertyDescriptorNamed(a):o.addToOnePropertyDescriptorNamed(a),o.addPropertyDescriptorGroupNamed(l,n.objectName)}var c=Object.getPrototypeOf(i);return c&&"objectDescriptor"in c?c.objectDescriptor.then(function(e){return o.parent=e,o}):s.resolve(o)}return s.resolve(t.UnknownObjectDescriptor)}}});t.UnknownObjectDescriptor=Object.freeze((new d).initWithName("Unknown")),t.UnknownPropertyDescriptor=Object.freeze((new l).initWithNameObjectDescriptorAndCardinality("Unknown",null,1)),t.UnknownEventDescriptor=Object.freeze((new o).initWithNameAndObjectDescriptor("Unknown",null))}}),montageDefine("b7b5e36","ui/base/abstract-slider",{dependencies:["./abstract-control","../../composer/translate-composer","../../composer/key-composer"],factory:function(e,t,i){var r=e("./abstract-control").AbstractControl,n=e("../../composer/translate-composer").TranslateComposer,o=e("../../composer/key-composer").KeyComposer;t.AbstractSlider=r.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractSlider cannot be instantiated.");this._propertyNamesUsed={},this.addOwnPropertyChangeListener("_sliderMagnitude",this),this.addOwnPropertyChangeListener("_min",this),this.addOwnPropertyChangeListener("_max",this),this.addOwnPropertyChangeListener("_value",this),this.addOwnPropertyChangeListener("_step",this),this.addOwnPropertyChangeListener("axis",this),this.axis="horizontal",this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage-Slider--active')",{"<-":"active"})}},enterDocument:{value:function(e){if(e){this._translateComposer=new n,this._translateComposer.identifier="thumb",this._translateComposer.axis=this.axis,this._translateComposer.hasMomentum=!1,this.addComposerForElement(this._translateComposer,this._sliderThumbElement),"webkitTransform"in this.element.style?this._transform="webkitTransform":"MozTransform"in this.element.style?this._transform="MozTransform":"oTransform"in this.element.style?this._transform="oTransform":this._transform="transform";var t=this._propertyNamesUsed;t._min||(this.min=this.element.getAttribute("min")||this._min),t._max||(this.max=this.element.getAttribute("max")||this._max),t._step||(this.step=this.element.getAttribute("step")||this._step),t._value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this.element.setAttribute("role","slider"),this.element.tabIndex="-1",this._upKeyComposer=o.createKey(this,"up","increase"),this._downKeyComposer=o.createKey(this,"down","decrease"),this._rightKeyComposer=o.createKey(this,"right","increase"),this._leftKeyComposer=o.createKey(this,"left","decrease")}}},prepareForActivationEvents:{value:function(){this._translateComposer.addEventListener("translateStart",this,!1),this._translateComposer.addEventListener("translate",this,!1),this._translateComposer.addEventListener("translateEnd",this,!1),this._sliderThumbElement.addEventListener("touchstart",this,!1),document.addEventListener("touchend",this,!1),this._sliderThumbElement.addEventListener("mousedown",this,!1),document.addEventListener("mouseup",this,!1),this._upKeyComposer.addEventListener("keyPress",this,!1),this._downKeyComposer.addEventListener("keyPress",this,!1),this._leftKeyComposer.addEventListener("keyPress",this,!1),this._rightKeyComposer.addEventListener("keyPress",this,!1)}},willDraw:{value:function(){this._sliderMagnitude=this._calculateSliderMagnitude()}},_previousPercentage:{value:null},draw:{value:function(){"vertical"===this.axis?this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d(0,"+(this._previousPercentage-this._valuePercentage)*this._sliderMagnitude*.01+"px,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.top=100-this._valuePercentage+"%",this._sliderThumbElement.style.left=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage):this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d("+(this._valuePercentage-this._previousPercentage)*this._sliderMagnitude*.01+"px,0,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.left=this._valuePercentage+"%",this._sliderThumbElement.style.top=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage),this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleTouchstart:{value:function(e){this.active=!0,this.element.focus(),this._isUpdatingTranslate=!0}},handleTouchend:{value:function(e){this.active=!1}},handleMousedown:{value:function(e){this.active=!0,this.element.focus(),e.preventDefault(),this._isUpdatingTranslate=!0}},handleMouseup:{value:function(e){this.active=!1}},_isUpdatingTranslate:{value:!1},handleThumbTranslateStart:{value:function(e){"vertical"===this.axis?this._startTranslate=e.translateY:this._startTranslate=e.translateX,this._startValue=this.value}},handleThumbTranslate:{value:function(e){"vertical"===this.axis?this.value=this._startValue+(this._startTranslate-e.translateY)/this._sliderMagnitude*(this._max-this._min):this.value=this._startValue+(e.translateX-this._startTranslate)/this._sliderMagnitude*(this._max-this._min),this._isUpdatingTranslate=!0}},handleThumbTranslateEnd:{value:function(e){this.active=!1,this._isUpdatingTranslate=!1}},_increase:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,i=this.step|(this.max-this.min)/100;t%i?t<0?t-=t%i:t+=i-t%i:t+=i,this.value=t+e}},_decrease:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,i=this.step|(this.max-this.min)/100;t-=t%i?t>0?t%i:i+t%i:i,this.value=t+e}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this._increase():"decrease"===e.identifier&&this._decrease())}},surrenderPointer:{value:function(e,t){return!1}},active:{value:!1},_min:{value:0},_max:{value:100},_step:{value:"any"},min:{get:function(){return this._min},set:function(e){isNaN(e=parseFloat(e))||this._min!==e&&(this._min=e)}},max:{get:function(){return this._max},set:function(e){isNaN(e=parseFloat(e))||this._max!==e&&(this._max=e)}},step:{get:function(){return this._step},set:function(e){!isNaN(e=parseFloat(e))&&e>=0&&this._step!==e&&(this._step=e)}},_value:{value:50},value:{get:function(){return this._value},set:function(e){isNaN(e=parseFloat(e))||(e>this._max?e=this._max:e<this._min&&(e=this._min),this._value!==e&&(this._value=e))}},enabled:{value:!0},axis:{value:null},_sliderThumbElement:{value:null},_translateComposer:{value:null},_transform:{value:null},_transition:{value:null},_sliderMagnitude:{value:null},_startTranslate:{value:null},_startValue:{value:null},_valuePercentage:{value:null},_calculateSliderMagnitude:{value:function(){var e=window.getComputedStyle(this._element);return"vertical"===this.axis?this._element.clientHeight-parseFloat(e.getPropertyValue("padding-top"))-parseFloat(e.getPropertyValue("padding-bottom")):this._element.clientWidth-parseFloat(e.getPropertyValue("padding-left"))-parseFloat(e.getPropertyValue("padding-right"))}},handleAxisChange:{value:function(){this._translateComposer&&(this._translateComposer.axis=this.axis),"vertical"===this.axis?(this.classList.add("montage-Slider--vertical"),this.classList.remove("montage-Slider--horizontal")):(this.classList.remove("montage-Slider--vertical"),this.classList.add("montage-Slider--horizontal"))}},_propertyRegex:{value:/_sliderMagnitude|_min|_max|_value|_step/},handlePropertyChange:{value:function(e,t,i){if(null!==t.match(this._propertyRegex)){if(this._propertyNamesUsed&&(this._propertyNamesUsed[t]=!0),this._value<=this._min)this._value=this._min;else{var r=this._value-this._min,n=r%this._step;if(n){var o=n>=.5*this._step&&this._value-n+this._step<=this._max;o?this._value=this._value-n+this._step:this._value=this._value-n}}this._value>this._max&&(this._value=this._max),this._valuePercentage=100*(this._value-this._min)/(this._max-this._min),this.needsDraw=!0}}}})}}),montageDefine("b7b5e36","data/service/raw-data-service",{dependencies:["data/service/data-service","data/service/data-mapping","data/model/data-identifier","core/serialization/deserializer/montage-deserializer","collections/map","montage","collections/weak-map","core/deprecate"],factory:function(e,t,i){var r=e("data/service/data-service").DataService,n=e("data/service/data-mapping").DataMapping,o=e("data/model/data-identifier").DataIdentifier,a=e("core/serialization/deserializer/montage-deserializer").MontageDeserializer,s=e("collections/map"),l=e("montage").Montage,u=e("collections/weak-map"),c=e("core/deprecate");t.RawDataService=r.specialize({constructor:{value:function(){r.call(this),this._typeIdentifierMap=new s}},initWithModel:{value:function(t){var i=this;return e.async(t).then(function(t){var i=(new a).init(JSON.stringify(t),e);return i.deserializeObject()}).then(function(e){return i.model=e,i})}},deserializeSelf:{value:function(e){this["super"](e)}},connectionDescriptor:{value:void 0},connection:{value:void 0},_propertyDescriptorForObjectAndName:{value:function(e,t){var i=this.objectDescriptorForObject(e);return i&&i.propertyDescriptorForName(t)}},_objectDescriptorForObject:{value:function(e){var t,i,r,n,o,a=this.types,s=l.getInfoForObject(e),u=s.moduleId,c=s.objectName;for(n=0,o=a.length;n<o&&!r;n+=1)t=a[n].module,i=t&&a[n].exportName,t&&u===t.id&&c===i&&(r=a[n]);return r}},_mapObjectPropertyValue:{value:function(e,t,i){var r=t.name;if(t.cardinality===1/0?this.spliceWithArray(e[r],i):e[r]=i[0],t.inversePropertyName&&i&&i[0]){var n=this._propertyDescriptorForObjectAndName(i[0],t.inversePropertyName);n&&1===n.cardinality&&i.forEach(function(i){i[t.inversePropertyName]=e})}return i}},_objectDescriptorTypeForValueDescriptor:{value:function(e){return e.then(function(e){return e.module.require.async(e.module.id)})}},_fetchRawData:{value:function(e){var t=this,i=this._childServiceForQuery(e.query),n=e.query;i?i._fetchRawData(e):n.authorization?(e.query=t.mapSelectorToRawDataQuery(n),t.fetchRawData(e),e.query=n):this.authorizationPolicy===r.AuthorizationPolicy.NONE?(e.query=t.mapSelectorToRawDataQuery(n),t.fetchRawData(e),e.query=n):r.authorizationManager.authorizeService(this).then(function(e){return t.authorization=e,e})["catch"](function(e){console.log(e)}).then(function(i){e.query=t.mapSelectorToRawDataQuery(n),t.fetchRawData(e),e.query=n})}},fetchRawData:{value:function(e){this.rawDataDone(e)}},cancelRawDataStream:{value:function(e,t){}},deleteDataObject:{value:function(e){var t={};return this._mapObjectToRawData(e,t),this.deleteRawData(t,e)}},deleteRawData:{value:function(e,t){return this.nullPromise}},saveRawData:{value:function(e,t){return this.nullPromise}},isOffline:{get:function(){return this===this.rootService?this.superForGet("isOffline")():this.rootService.isOffline}},writeOfflineData:{value:function(e,t,i){return this.nullPromise}},addRawData:{value:function(e,t,i){var r,n,o,a,s=e.query.type;for(r=t&&!this.isOffline&&this._streamRawData.get(e),r?r.push.apply(r,t):t&&!this.isOffline&&this._streamRawData.set(e,t.slice()),n=0,o=t&&t.length;n<o;n+=1)a=t[n],this.addOneRawData(e,a,i,s).then(function(t){e.addData([t])})}},addOneRawData:{value:function(e,t,i){var r,n=this.objectForTypeRawData(e.query.type,t,i);return r=this._mapRawDataToObject(t,n,i),r=r&&r instanceof Promise?r.then(function(){return n}):Promise.resolve(n),this._addMapDataPromiseForStream(r,e),n&&this.callDelegateMethod("rawDataServiceDidAddOneRawData",this,e,t,n),r}},_addMapDataPromiseForStream:{value:function(e,t){this._streamMapDataPromises.has(t)?this._streamMapDataPromises.get(t).push(e):this._streamMapDataPromises.set(t,[e])}},_streamMapDataPromises:{get:function(){return this.__streamMapDataPromises||(this.__streamMapDataPromises=new s),this.__streamMapDataPromises}},objectForTypeRawData:{value:function(e,t,i){var r=this.dataIdentifierForTypeRawData(e,t);return this.recordSnapshot(r,t),this.getDataObject(e,t,i,r)}},_typeIdentifierMap:{value:void 0},dataIdentifierForTypeRawData:{value:function(e,t){var i,r,n,a,l=this.mappingWithType(e),u=l?l.rawDataPrimaryKeys:null;if(u&&u.length){n=this._typeIdentifierMap.get(e),n||this._typeIdentifierMap.set(e,n=new s);for(var c,h=0;c=u[h];h++)i=i||[],i[h]=t[c];return i&&(a=i.join("/"),r=n.get(a)),r||(e.typeName||e.name,r=new o,r.objectDescriptor=e,r.dataService=this,r.typeName=e.name,r._identifier=r.primaryKey=a,n.set(a,r)),r}}},__snapshot:{value:null},_snapshot:{get:function(){return this.__snapshot||(this.__snapshot=new s)}},recordSnapshot:{value:function(e,t){this._snapshot.set(e,t)}},removeSnapshot:{value:function(e){this._snapshot["delete"](e)}},snapshotForDataIdentifier:{value:function(e){return this._snapshot.get(e)}},snapshotForObject:{value:function(e){return this.snapshotForDataIdentifier(this.dataIdentifierForObject(e))}},rawDataDone:{value:function(e,t){var i=this,r=this._streamRawData.get(e),n=this._streamMapDataPromises.get(e),o=n?Promise.all(n):this.nullPromise;n&&this._streamMapDataPromises["delete"](e),r&&this._streamRawData["delete"](e),o.then(function(n){return r?i.writeOfflineData(r,e.query,t):null}).then(function(){return e.dataDone(),null})["catch"](function(e){console.error(e)})}},_streamRawData:{get:function(){return this.__streamRawData||(this.__streamRawData=new u),this.__streamRawData}},__streamRawData:{value:void 0},mapSelectorToRawDataQuery:{value:function(e){return e}},mapSelectorToRawDataSelector:{value:c.deprecateMethod(void 0,function(e){return this.mapSelectorToRawDataQuery(e)},"mapSelectorToRawDataSelector","mapSelectorToRawDataQuery")},mappingForObject:{value:function(e){var t=this.objectDescriptorForObject(e),i=t&&this.mappingWithType(t);return!i&&t&&(i=this._objectDescriptorMappings.get(t),i||(i=n.withObjectDescriptor(t),this._objectDescriptorMappings.set(t,i))),i}},mapRawDataToObject:{value:function(e,t,i){}},_mapRawDataToObject:{value:function(e,t,i){var r,n=this,o=this.mappingForObject(t);return o?(r=o.mapRawDataToObject(e,t,i),r=r?r.then(function(){return n.mapRawDataToObject(e,t,i)}):this.mapRawDataToObject(e,t,i)):r=this.mapRawDataToObject(e,t,i),r}},mapObjectToRawData:{value:function(e,t,i){}},_mapObjectToRawData:{value:function(e,t,i){var r,n=this.mappingForObject(e);if(n&&(r=n.mapObjectToRawData(e,t,i)),t)if(r){var o=this.mapObjectToRawData(e,t,i);r instanceof Promise&&o instanceof Promise?r=Promise.all([r,o]):o instanceof Promise&&(r=o)}else r=this.mapObjectToRawData(e,t,i);return r}},_mappingsPromise:{get:function(){return this.__mappingsPromise||(this.__mappingsPromise=Promise.all(this.mappings.map(function(e){return e.objectDescriptor})).then(function(e){})),this.__mappingsPromise}},_objectDescriptorMappings:{get:function(){return this.__objectDescriptorMappings||(this.__objectDescriptorMappings=new s),this.__objectDescriptorMappings}},mapFromRawData:{value:function(e,t,i){}},mapToRawData:{value:function(e,t){}},offlineService:{value:void 0}})}}),montageDefine("b7b5e36","data/service/http-service",{dependencies:["data/service/raw-data-service","data/model/data-query","data/model/enumeration","collections/map","montage","frb/parse","frb/compile-evaluator","frb/evaluate","frb/scope","core/promise"],factory:function(e,t,i){var r=e("data/service/raw-data-service").RawDataService,n=e("data/model/data-query").DataQuery,o=e("data/model/enumeration").Enumeration,a=e("collections/map"),s=e("montage").Montage,l=e("frb/parse"),u=e("frb/compile-evaluator"),c=(e("frb/evaluate"),e("frb/scope")),h=e("core/promise").Promise,d=t.HttpError=s.specialize({constructor:{value:function(){this.stack=(new Error).stack}},isAuthorizationError:{get:function(){return this._isAuthorizationError||401===this.statusCode||403===this.statusCode},set:function(e){this._isAuthorizationError=e}},message:{get:function(){return this._message||(this._message="Status "+this.statusCode+" received for url: "+this.url),this._message}},name:{value:"HttpError"},url:{value:void 0},statusCode:{value:void 0}},{withMessage:{value:function(e){var t=new this;return t._message=e,t}},withRequestAndURL:{value:function(e,t){var i=new this;return i.statusCode=e.status,i.url=t,i}}});t.HttpService=r.specialize({FORM_URL_ENCODED:{value:{"Content-Type":"application/x-www-form-urlencoded"}},FORM_URL_ENCODED_CONTENT_TYPE_HEADER:{get:function(){return console.warn("HttpService.FORM_URL_ENCODED_CONTENT_TYPE_HEADER is deprecated - use HttpService.FORM_URL_ENCODED instead"),this.FORM_URL_ENCODED}},setHeadersForQuery:{value:function(e,t){var i,r,n=t&&t.authorization&&t.authorization[0];n&&n.headerValueExpression&&this.authorizationHeaderName?(r=new c(n),i=u(l(n.headerValueExpression)),e[this.authorizationHeaderName]=i(r)):t&&this.authorizationHeaderName&&this.authorizationHeaderValueExpression?(r=new c(t),i=u(l(this.authorizationHeaderValueExpression)),e[this.authorizationHeaderName]=i(r)):this.authorizationHeaderName&&this.authorizationHeaderValue&&(e[this.authorizationHeaderName]=this.authorizationHeaderValue)}},authorizationHeaderName:{value:"Authorization"},authorizationHeaderValue:{value:void 0},authorizationHeaderValueExpression:{value:void 0},fetchHttpObjectProperty:{value:function(e,t,i,r,o){var a,s,l,u;return this._getCachedFetchPromise(t,i)||(s=arguments.length>=4?n.withTypeAndCriteria(e,arguments[arguments.length-1]):n.withTypeAndCriteria(e),l=arguments.length<5||!r?[]:Array.isArray(r)?r:Array.prototype.slice.call(arguments,3,-1),a=this,this._setCachedFetchPromise(t,i,this.nullPromise.then(function(){return a.rootService.getObjectProperties(t,l)}).then(function(){return u=a.rootService.fetchData(s)}).then(function(){return a.eventLoopPromise}).then(function(){return a._setCachedFetchPromise(t,i,null),u.data}))),this._getCachedFetchPromise(t,i)}},_getCachedFetchPromise:{value:function(e,t){return this._cachedFetchPromises=this._cachedFetchPromises||{},this._cachedFetchPromises[t]=this._cachedFetchPromises[t]||new a,this._cachedFetchPromises[t].get(e)}},_setCachedFetchPromise:{value:function(e,t,i){this._cachedFetchPromises=this._cachedFetchPromises||{},this._cachedFetchPromises[t]=this._cachedFetchPromises[t]||new a,this._cachedFetchPromises[t].set(e,i)}},_authRegexp:{value:new RegExp(/error=\"([^&]*)\"/)},_fetchHttpRawDataWithParsedArguments:{value:function(e){var t,i,r=this;return e?e.url||(t=new Error("No URL provided to fetchHttpRawData()")):t=new Error("Invalid arguments to fetchHttpRawData()"),new h(function(n,o){var a,s,l;if((new Date).getTime(),t)console.warn(t),o(t);else{for(i=new XMLHttpRequest,i.onreadystatechange=function(){4===i.readyState&&n(i)},i.onerror=function(){t=d.withRequestAndURL(i,e.url),o(t)},i.open(e.body?"POST":"GET",e.url,!0),r.setHeadersForQuery(e.headers,e.query,e.url),s=Object.keys(e.headers),a=0;l=s[a];++a)i.setRequestHeader(l,e.headers[l]);i.withCredentials=e.credentials,i.send(e.body)}}).then(function(){return r.eventLoopPromise}).then(function(){if(r._isRequestUnauthorized(i)&&"function"==typeof r.authorize)return r.authorize().then(function(){return r._fetchHttpRawDataWithParsedArguments(e)});if(!t&&(i.status>=300||0===i.status))throw d.withRequestAndURL(i,e.url);return e.types[0].parseResponse(i,e.url)})}},_isRequestUnauthorized:{value:function(e){return 401===e.status||"function"==typeof this.didAuthorizationFail&&this.didAuthorizationFail(e)}},fetchHttpRawData:{value:function(e,t,i,r,n,o){var a=this._parseFetchHttpRawDataArguments.apply(this,arguments);return this._fetchHttpRawDataWithParsedArguments(a)}},_parseFetchHttpRawDataArguments:{value:function(){var e,i,r,o;e={url:arguments[0]},i="string"==typeof e.url?arguments.length-1:-1,i<0&&console.warn(new Error("Invalid URL for fetchHttpRawData()")),e.credentials=i<1||arguments[i],e.credentials instanceof Boolean?e.credentials=e.credentials.valueOf():"boolean"!=typeof e.credentials&&(e.credentials=!0,i+=1);var a=i>1&&arguments[1]||{};if(e.headers={},"object"==typeof a&&Object.assign(e.headers,a),this._isBoolean(a)&&(console.warn(new Error("Invalid headers for fetchHttpRawData()")),i=-1),i>2&&arguments[2]&&(e.body=arguments[2],this._isBoolean(e.body)&&(console.warn(new Error("Invalid body for fetchHttpRawData()")),i=-1)),4===i&&Array.isArray(arguments[3]))e.types=arguments[3];else if(i<4||!(arguments[3]instanceof t.HttpService.DataType))e.types=[t.HttpService.DataType.JSON];else{for(r=3,o=i;r<o&&arguments[r]instanceof t.HttpService.DataType;)++r;
e.types=Array.prototype.slice.call(arguments,3,r),r<o&&(console.warn(new Error("Invalid types for fetchHttpRawData()")),i=-1)}return 5===i&&arguments[4]instanceof n?e.query=arguments[4]:4===i&&arguments[3]instanceof n&&(e.query=arguments[3]),i>=0?e:void 0}},_isBoolean:{value:function(e){return"boolean"==typeof e||e instanceof Boolean}},formUrlEncode:{value:function(e){return encodeURIComponent(e).replace(/ /g,"+").replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})}}},{DataType:{get:o.getterFor("_DataType",{BINARY:[{}],JSON:[{parseResponse:{value:function(e,t){var i=e&&e.responseText,r=null;if(i)try{r=JSON.parse(i)}catch(n){console.warn(new Error("Can't parse JSON received from "+t))}else e&&console.warn(new Error("No JSON response received from "+t));return r}}}],JSONP:[{parseResponse:{value:function(e,t){var i=e&&e.responseText,r=i&&i.indexOf("(")+1,n=i&&Math.max(i.lastIndexOf(")"),0),o=null;if(r&&n)try{o=i&&JSON.parse(i.slice(r,n))}catch(a){console.warn(new Error("Can't parse JSONP received from "+t)),console.warn("Response text:",i)}else i?(console.warn(new Error("Can't parse JSONP received from "+t)),console.warn("Response text:",i)):e&&console.warn(new Error("No JSONP response received from "+t));return o}}}],TEXT:[{parseResponse:{value:function(e,t){var i=e&&e.responseText;return!i&&e&&console.warn(new Error("No text response received from "+t)),i}}}],XML:[{}]})}})}}),montageDefine("b7b5e36","core/meta/object-property",{dependencies:["../core","../exception","./model","../deprecate","../logger"],factory:function(e,t,i){var r=e("../core").Montage,n=e("../exception").Exception,o=e("./model").Model,a=e("../deprecate"),s=e("../logger").logger("object-property");t.ObjectProperty=r.specialize({init:{serializable:!1,enumerable:!1,value:function(){return this}},apply:{value:function(e,t){var i;e.hasOwnProperty("objectDescriptor")||(i=r.getInfoForObject(e),null!==i&&i.isInstance===!1&&(void 0===t?t=o.group.objectDescriptorForPrototype(i.objectName,i.moduleId):t.prototypeName===i.objectName&&t.moduleId===i.moduleId||(t=null),this.applyWithObjectDescriptor(e,t)))}},applyWithBlueprint:{value:a.deprecateMethod(void 0,function(e,t){return this.applyWithObjectDescriptor(e,t)},"applyWithBlueprint","applyWithObjectDescriptor")},applyWithObjectDescriptor:{value:function(e,t){null!==t&&(this.addProperties(e,t),null!==t.parent&&this.apply(Object.getPrototypeOf(e),t))}},addProperties:{value:function(e,t){for(var i,n=0;i=t.propertyDescriptors[n++];)i.isDerived?this.addDerivedProperty(e,i):i.isAssociation?this.addAssociation(e,i):this.addProperty(e,i);r.defineProperty(e,"blueprint",{enumerable:!1,serializable:!1,get:function(){return this._objectDescriptor}}),r.defineProperty(e,"_objectDescriptor",{serializable:!1,enumerable:!1,value:t}),r.defineProperty(e,"objectDescriptor",{enumerable:!1,serializable:!1,get:function(){return this._objectDescriptor}}),r.defineProperty(e,"blueprintGet",{serializable:!1,enumerable:!1,value:this.objectDescriptorGet}),r.defineProperty(e,"blueprintSet",{serializable:!1,enumerable:!1,value:this.objectDescriptorSet}),r.defineProperty(e,"objectDescriptorGet",{serializable:!1,enumerable:!1,value:this.objectDescriptorGet}),r.defineProperty(e,"objectDescriptorSet",{serializable:!1,enumerable:!1,value:this.objectDescriptorSet})}},addProperty:{value:function(e,t){this.addPropertyStorage(e,t),this.addPropertyDefinition(e,t),this.addPropertyStoredValue(e,t)}},addPropertyStorage:{value:function(e,t){var i="_"+t.name,n="_"+i,o=null;e.hasOwnProperty(i)?s.isError&&s.error("We have an issue here. The developer should not override the storage value for "+i+"."):(t.isToMany?(r.defineProperty(e,n,{value:null,enumerable:!1,serializable:!1}),o={get:function(){return this[n]||(this[n]=[])},enumerable:!1,serializable:!0}):o={value:null,enumerable:!1,serializable:!0},r.defineProperty(e,i,o))}},addPropertyDefinition:{value:function(e,t){var i=t.name,n=null;e.hasOwnProperty(i)?s.isDebug&&s.debug("The developer has already created the property "+i+" method do nothing."):(n={get:function(){return this.objectDescriptorGet(i)},enumerable:!0,serializable:!1},t.readOnly||(n.set=function(e){return this.objectDescriptorSet(i,e)}),r.defineProperty(e,i,n))}},blueprintGet:{value:a.deprecateMethod(void 0,function(e){return this.objectDescriptorGet(e)},"blueprintGet","objectDescriptorGet"),enumerable:!1,serializable:!1},objectDescriptorGet:{value:function(e){var t=this.objectDescriptor.propertyDescriptorForName(e),i="_"+t.name;return this[i]},enumerable:!1,serializable:!1},blueprintSet:{value:a.deprecateMethod(void 0,function(e,t){return this.objectDescriptorSet(e,t)},"blueprintSet","objectDescriptorSet"),enumerable:!1,serializable:!1},objectDescriptorSet:{value:function(e,t){var i=this.objectDescriptor.propertyDescriptorForName(e),r="_"+i.name;if(null===t&&i.denyDelete)throw(new n).initWithMessageTargetAndMethod("Deny Delete",this,i.name);this[r]=t},enumerable:!1,serializable:!1},addPropertyStoredValue:{value:function(e,t){var i=t.name+"$Storage",n="_"+i,o=null;e.hasOwnProperty(i)?s.isError&&s.error("We have an issue here. The developer should not override the stored value for "+i+"."):(t.isToMany?(r.defineProperty(e,n,{value:null,enumerable:!1,serializable:!1}),o={get:function(){return this[n]||(this[n]=[])},enumerable:!1,serializable:!1}):o={value:null,enumerable:!1,serializable:!1},r.defineProperty(e,i,o))}},addAssociation:{value:function(e,t){this.addPropertyStorage(e,t),this.addAssociationDefinition(e,t),this.addPropertyStoredValue(e,t)}},addAssociationDefinition:{value:function(e,t){t.isToMany?this.addToManyAssociationDefinition(e,t):this.addToOneAssociationDefinition(e,t)}},addToOneAssociationDefinition:{value:function(e,t){var i=t.name.toCapitalized(),n="addTo"+i;e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}}),n="removeFrom"+i,e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}}),n="clear"+i,e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}})}},addToManyAssociationDefinition:{value:function(e,t){var i=t.name.toCapitalized(),n="addTo"+i;e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}}),n="removeFrom"+i,e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}}),n="clear"+i,e.hasOwnProperty(n)?s.isError&&s.error("We have an issue here. The developer should not override the method "+n+"."):r.defineProperty(e,n,{serializable:!1,enumerable:!1,value:function(){return null}})}},addDerivedProperty:{value:function(e,t){}}})}}),montageDefine("b7b5e36","core/meta/property-descriptor",{dependencies:["../core","../promise","../deprecate","../logger","../core","../core","../core","../core"],factory:function(e,t,i){var r=e("../core").Montage,n=e("../promise").Promise,o=e("../deprecate"),a=(e("../logger").logger("objectDescriptor"),{name:"default",cardinality:1,mandatory:!1,readOnly:!1,denyDelete:!1,valueType:"string",collectionValueType:"list",valueObjectPrototypeName:"",valueObjectModuleId:"",valueDescriptor:void 0,enumValues:[],defaultValue:void 0,helpKey:""});t.PropertyDescriptor=r.specialize({initWithNameObjectDescriptorAndCardinality:{value:function(e,t,i){return this._name=null!==e?e:a.name,this._owner=t,this.cardinality=i>0?i:a.cardinality,this}},initWithNameBlueprintAndCardinality:{value:o.deprecateMethod(void 0,function(e,t,i){return this.initWithNameObjectDescriptorAndCardinality(e,t,i)},"new PropertyBlueprint().initWithNameBlueprintAndCardinality","new PropertyDescriptor().initWithNameObjectDescriptorAndCardinality")},serializeSelf:{value:function(e){e.setProperty("name",this.name),e.setProperty("objectDescriptor",this._owner,"reference"),this.cardinality===1/0?e.setProperty("cardinality",-1):this._setPropertyWithDefaults(e,"cardinality",this.cardinality),this._setPropertyWithDefaults(e,"mandatory",this.mandatory),this._setPropertyWithDefaults(e,"readOnly",this.readOnly),this._setPropertyWithDefaults(e,"denyDelete",this.denyDelete),this._setPropertyWithDefaults(e,"valueType",this.valueType),this._setPropertyWithDefaults(e,"collectionValueType",this.collectionValueType),this._setPropertyWithDefaults(e,"valueObjectPrototypeName",this.valueObjectPrototypeName),this._setPropertyWithDefaults(e,"valueObjectModuleId",this.valueObjectModuleId),this._setPropertyWithDefaults(e,"valueDescriptor",this._valueDescriptorReference),this.enumValues.length>0&&this._setPropertyWithDefaults(e,"enumValues",this.enumValues),this._setPropertyWithDefaults(e,"defaultValue",this.defaultValue),this._setPropertyWithDefaults(e,"helpKey",this.helpKey),this._setPropertyWithDefaults(e,"definition",this.definition)}},deserializeSelf:{value:function(e){var t;t=e.getProperty("name"),void 0!==t&&(this._name=t),t=e.getProperty("objectDescriptor")||e.getProperty("blueprint"),void 0!==t&&(this._owner=t),this._overridePropertyWithDefaults(e,"cardinality"),this.cardinality===-1&&(this.cardinality=1/0),this._overridePropertyWithDefaults(e,"mandatory"),this._overridePropertyWithDefaults(e,"readOnly"),this._overridePropertyWithDefaults(e,"denyDelete"),this._overridePropertyWithDefaults(e,"valueType"),this._overridePropertyWithDefaults(e,"collectionValueType"),this._overridePropertyWithDefaults(e,"valueObjectPrototypeName"),this._overridePropertyWithDefaults(e,"valueObjectModuleId"),this._overridePropertyWithDefaults(e,"_valueDescriptorReference","valueDescriptor","targetBlueprint"),this._overridePropertyWithDefaults(e,"enumValues"),this._overridePropertyWithDefaults(e,"defaultValue"),this._overridePropertyWithDefaults(e,"helpKey"),this._overridePropertyWithDefaults(e,"definition")}},_setPropertyWithDefaults:{value:function(e,t,i){null!==i&&i!==a[t]&&e.setProperty(t,i)}},_getPropertyWithDefaults:{value:function(e){var t,i,r,n=Array.prototype.slice.call(arguments).slice(1,1/0);for(i=0,r=n.length;i<r&&!t;i+=1)t=e.getProperty(n[i]);return t||a[n[0]]}},_overridePropertyWithDefaults:{value:function(e,t){var i,r,n,o;for(i=arguments.length>2?Array.prototype.slice.call(arguments,2,1/0):[t],n=0,o=i.length;n<o&&!r;n++)r=e.getProperty(i[n]);this[t]=void 0===r?a[i[0]]:r}},_owner:{value:null},owner:{get:function(){return this._owner}},_name:{value:null},name:{serializable:!1,get:function(){return this._name}},identifier:{get:function(){return[this.owner.identifier,this.name].join("_")}},cardinality:{value:a.cardinality},mandatory:{value:a.mandatory},denyDelete:{value:a.denyDelete},readOnly:{value:a.readOnly},isToMany:{get:function(){return this.cardinality===1/0||this.cardinality>1}},isDerived:{get:function(){return!1}},definition:{value:null},valueType:{value:a.valueType},collectionValueType:{value:a.collectionValueType},valueObjectPrototypeName:{value:a.valueObjectPrototypeName},valueObjectModuleId:{value:a.valueObjectModuleId},valueDescriptor:{serializable:!1,get:function(){return this._valueDescriptorReference&&"function"==typeof this._valueDescriptorReference.promise?(o.deprecationWarningOnce("valueDescriptor reference via ObjectDescriptorReference","direct reference via object syntax"),this._valueDescriptorReference.promise(this.require)):n.resolve(this._valueDescriptorReference)},set:function(e){this._valueDescriptorReference=e}},_targetObjectDescriptorReference:{value:null},_enumValues:{value:null},enumValues:{get:function(){return this._enumValues?this._enumValues:[]},set:function(e){Array.isArray(e)&&(this._enumValues=e)}},defaultValue:{value:a.defaultValue},helpKey:{value:a.helpKey},objectDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,objectDescriptor:e("../core")._objectDescriptorDescriptor,serializable:{value:!0},isAssociationBlueprint:{get:o.deprecateMethod(void 0,function(){return!!this._valueDescriptorReference},"isAssociationBlueprint","No analog")},targetBlueprint:{get:o.deprecateMethod(void 0,function(){return this.valueDescriptor},"targetBlueprint.get","valueDescriptor.get"),set:o.deprecateMethod(void 0,function(e){this.valueDescriptor=e},"targetBlueprint.get","valueDescriptor.set")},blueprintDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,blueprint:e("../core")._objectDescriptorDescriptor})}}),montageDefine("b7b5e36","data/service/data-trigger",{dependencies:["core/core","data/model/data-object-descriptor","data/model/object-descriptor","collections/weak-map"],factory:function(e,t,i){var r,n=e("core/core").Montage,o=e("data/model/data-object-descriptor").DataObjectDescriptor,a=e("data/model/object-descriptor").ObjectDescriptor,s=e("collections/weak-map");r=t.DataTrigger=function(){},t.DataTrigger.prototype=Object.create({},{constructor:{configurable:!0,writable:!0,value:t.DataTrigger},_service:{configurable:!0,writable:!0,value:void 0},_objectPrototype:{configurable:!0,writable:!0,value:void 0},_propertyName:{configurable:!0,writable:!0,value:void 0},_privatePropertyName:{configurable:!0,get:function(){return!this.__privatePropertyName&&this._propertyName&&(this.__privatePropertyName="_"+this._propertyName),this.__privatePropertyName}},_isGlobal:{configurable:!0,get:function(){return!(this._valueStatus instanceof s)},set:function(e){e=!!e,e!==this._isGlobal&&(this._valueStatus=e?void 0:new s)}},_valueStatus:{configurable:!0,writable:!0,value:void 0},_getValueStatus:{configurable:!0,value:function(e){return this._isGlobal?this._valueStatus:this._valueStatus.get(e)}},_setValueStatus:{configurable:!0,value:function(e,t){this._isGlobal?this._valueStatus=t:void 0!==t?this._valueStatus.set(e,t):this._valueStatus["delete"](e)}},_getValue:{configurable:!0,writable:!0,value:function(e){var t,i,r;for(this.getObjectProperty(e),t=Object.getPrototypeOf(this._objectPrototype);t;)i=Object.getOwnPropertyDescriptor(t,this._propertyName),r=i&&i.get,t=!r&&Object.getPrototypeOf(t);return r?r.call(e):e[this._privatePropertyName]}},_setValue:{configurable:!0,writable:!0,value:function(e,t){var i,r,n,o,a,s;for(i=this._getValueStatus(e),this._setValueStatus(e,null),r=Object.getPrototypeOf(this._objectPrototype);r;)n=Object.getOwnPropertyDescriptor(r,this._propertyName),o=n&&n.get,a=o&&n.set,s=!n||a||n.writable,r=s&&!a&&Object.getPrototypeOf(r);a?a.call(e,t):s&&(e[this._privatePropertyName]=t),i&&i.resolve(null)}},decacheObjectProperty:{value:function(e){this._setValueStatus(e,void 0)}},getObjectProperty:{value:function(e){var t=this._getValueStatus(e);return t?t.promise:null===t?this._service.nullPromise:this.updateObjectProperty(e)}},updateObjectProperty:{value:function(e){var t=this,i=this._getValueStatus(e)||{};return i.promise||(this._setValueStatus(e,i),i.promise=new Promise(function(r,n){i.resolve=r,i.reject=n,t._fetchObjectProperty(e)})),i.promise}},_fetchObjectProperty:{value:function(e){var t=this;this._service.fetchObjectProperty(e,this._propertyName).then(function(){return t._fulfillObjectPropertyFetch(e)})["catch"](function(i){return console.error(i),t._fulfillObjectPropertyFetch(e,i)})}},_fulfillObjectPropertyFetch:{value:function(e,t){var i=this._getValueStatus(e);return this._setValueStatus(e,null),i&&!t?i.resolve(null):i&&t&&(console.error(t),i.reject(t)),null}}}),Object.defineProperties(t.DataTrigger,{addTriggers:{value:function(e,t,i,r){var n=t instanceof o||t instanceof a;return n?this._addTriggersForMontageDataType(e,t,i,name):this._addTriggers(e,t,i,r)}},_addTriggersForMontageDataType:{value:function(e,t,i){var r,n,o,a={},s=Object.keys(t.propertyDescriptors);for(o=0;n=s[o];++o)r=this.addTrigger(e,t,i,n),r&&(a[n]=r);return a}},_addTriggers:{value:function(e,t,i,r){var n,o,a,s,l,u={};for(s=0,l=t.propertyDescriptors.length;s<l;s+=1)n=t.propertyDescriptors[s],r.has(n.name)||(a=n.name,o=this.addTrigger(e,t,i,a),o&&(u[a]=o));return u}},addTrigger:{value:function(e,t,i,r){var n=t instanceof o||t instanceof a;return n?this._addTriggerForMontageDataType(e,t,i,r):this._addTrigger(e,t,i,r)}},_addTriggerForMontageDataType:{value:function(e,t,i,r){var o,a=t.propertyDescriptors[r];return a&&a.isRelationship&&(o=Object.create(this._getTriggerPrototype(e)),o._objectPrototype=i,o._propertyName=r,o._isGlobal=a.isGlobal,n.defineProperty(i,r,{get:function(){return o._getValue(this)},set:function(e){o._setValue(this,e)}})),o}},_createTrigger:{value:function(e,t,i,r,n){var o=Object.create(this._getTriggerPrototype(e)),a=e._dataObjectTriggers.get(t);return o._objectPrototype=i,o._propertyName=r,o._isGlobal=n.isGlobal,a||(a={},e._dataObjectTriggers.set(t,a)),a[r]=o,o}},_addTrigger:{value:function(e,t,i,r){var o,a=t.propertyDescriptorForName(r);return a&&(o=Object.create(this._getTriggerPrototype(e)),o._objectPrototype=i,o._propertyName=r,o._isGlobal=a.isGlobal,a.definition?n.defineProperty(i,r,{get:function(){return this.getBinding(r)||this.defineBinding(r,{"<-":a.definition}),o._getValue(this)},set:function(e){o._setValue(this,e)}}):n.defineProperty(i,r,{get:function(){return o._getValue(this)},set:function(e){o._setValue(this,e)}}),o=Object.create(this._getTriggerPrototype(e)),o._objectPrototype=i,o._propertyName=r,o._isGlobal=a.isGlobal),o}},_getTriggerPrototype:{value:function(e){var t=this._triggerPrototypes&&this._triggerPrototypes.get(e);return t||(t=new this,t._service=e,this._triggerPrototypes=this._triggerPrototypes||new s,this._triggerPrototypes.set(e,t)),t}},removeTriggers:{value:function(e,t){var i,r,n=Object.keys(e);for(r=0;i=n[r];++r)this.removeTrigger(e[i],t,i)}},removeTrigger:{value:function(e,t){e&&delete t[e.name]}}})}}),montageDefine("b7b5e36","data/service/authorization-manager",{dependencies:["core/core","core/promise","collections/map","core/application","data/service/authorization-policy"],factory:function(e,t,i){var r=e("core/core").Montage,n=e("core/promise").Promise,o=e("collections/map"),a=e("core/application").application,s=e("data/service/authorization-policy").AuthorizationPolicy,l="ui/authorization-manager-panel.reel",u=r.specialize({constructor:{value:function(){return this._providersByModuleID=new o,this._panelsByModuleID=new o,this._authorizationsByProviderModuleID=new o,this.defineBinding("hasPendingServices",{"<-":"_pendingServicesCount != 0"}),this}},_authorizationsByProviderModuleID:{value:void 0},_panelsByModuleID:{value:void 0},_providersByModuleID:{value:void 0},_managerPanel:{value:function(){var t,i=this;return!this._managerPanelPromise&&this.authorizationManagerPanel?(this.authorizationManagerPanel.authorizationManager=this,this._managerPanelPromise=n.resolve(this.authorizationManagerPanel)):this._managerPanelPromise||(t=this.callDelegateMethod("authorizationManagerWillLoadAuthorizationManagerPanel",this,l)||l,this._managerPanelPromise=e.async(t).bind(this).then(function(e){var t=new e.AuthorizationManagerPanel;return i.authorizationManagerPanel=t,t.authorizationManager=i,t})["catch"](function(e){console.log(e)})),this._managerPanelPromise}},_panelForProvider:{value:function(e){var t=this._panelModuleIDForProvider(e),i=this._panelsByModuleID.get(t);return i?n.resolve(i):this._makePanelForProvider(t,e)}},_panelModuleIDForProvider:{value:function(e){var t=e.authorizationPanel;return this.callDelegateMethod("authorizationManagerWillAuthorizeServiceWithPanelModuleId",this,e,t)||t}},_makePanelForProvider:{value:function(e,t){var i,n=this,o=r.getInfoForObject(t);return e&&(i=o.require.async(e).then(function(i){var r,o,a,s=Object.keys(i);for(o=0,a=s.length;o<a&&!r;++o)r=n._panelForConstructorAndProvider(i[s[o]],t);return r.service=t,n._panelsByModuleID.set(e,r),r})),i}},_panelForConstructorAndProvider:{value:function(e,t){return this.callDelegateMethod("authorizationManagerWillInstantiateAuthorizationPanelForService",this,e,t)||new e}},_canNotifyDataService:{value:function(e){return e.authorizationManagerWillAuthorizeWithService&&"function"==typeof e.authorizationManagerWillAuthorizeWithService}},_providersForDataService:{value:function(e){var t,i,o,a=[],s=r.getInfoForObject(e),l=e.authorizationServices;for(i=0,o=l.length;i<o;++i)t=this._providerWithModuleID(l[i],s.require),a.push(t);return n.all(a)}},_providerWithModuleID:{value:function(e,t){var i=this._providersByModuleID.get(e);return i?n.resolve(i):this._makeProviderWithModuleID(e,t)}},_authorizationWithProvider:{value:function(e,t){var i,r=this;return this._providerWithModuleID(e,t).then(function(e){return i=e,i.authorize()}).then(function(e){return e||r._authorizeProviderWithManagerPanel(i)})}},_authorizeProviderWithManagerPanel:{value:function(e){var t,i=this;return i._pendingServicesCount++,this._managerPanel().then(function(r){return t=r,i._panelForProvider(e)}).then(function(e){return t.authorizeWithPanel(e)}).then(function(e){return i._pendingServicesCount--,e})}},_makeProviderWithModuleID:{value:function(e,t){var i=this;return t.async(e).then(function(e){var t,r,n,o=Object.keys(e);for(r=0;n=o[r];++r)t=t||new e[n];return i.registerAuthorizationService(t),t})}},_notifyDataService:{value:function(e){var t,i;return this._canNotifyDataService(e)?this._providersForDataService(e).then(function(r){for(t=0,i=r.length;t<i;t++)e.authorizationManagerWillAuthorizeWithService(this,r[t])}):n.resolve(null)}},authorizationManagerPanel:{value:void 0},authorizeService:{value:function(e,t){var i=this,r=[];return e.authorizationPolicy===s.NONE?n.resolve(null):(r=this._authorizationsForDataService(e),r.length?n.all(r):e.authorizationPolicy!==s.ON_DEMAND||t?(r=this._authorizationsForDataService(e,!0),i._notifyDataService(e).then(function(){var e=a.applicationModal&&i.authorizationManagerPanel.runModal;return e?i.authorizationManagerPanel.runModal():n.all(r)}).then(function(t){return i.callDelegateMethod("authorizationManagerDidAuthorizeService",i,e),t})["catch"](function(){i.hasPendingServices=!1})):n.resolve(null))}},_authorizationsForDataService:{value:function(e,t){var i,n,o,a,s=[],l=r.getInfoForObject(e);for(o=0,a=e.authorizationServices.length;o<a;o++)n=e.authorizationServices[o],i=this._authorizationForServiceFromProvider(n,l.require,t),i&&s.push(i);return s}},_authorizationForServiceFromProvider:{value:function(e,t,i){var r=null;return this._authorizationsByProviderModuleID.has(e)?r=this._authorizationsByProviderModuleID.get(e):i&&(r=this._authorizationWithProvider(e,t),this._authorizationsByProviderModuleID.set(e,r)),r}},_pendingServicesCount:{value:0},delegate:{value:null},hasPendingServices:{value:!1},registerAuthorizationService:{value:function(e){var t=r.getInfoForObject(e);this._providersByModuleID.set(t.moduleId,e)}}});t.AuthorizationManager=new u}}),montageDefine("b7b5e36","ui/base/abstract-number-field",{dependencies:["./abstract-control","../../composer/key-composer"],factory:function(e,t,i){var r=e("./abstract-control").AbstractControl,n=e("../../composer/key-composer").KeyComposer;t.AbstractNumberField=r.specialize({constructor:{value:function o(){if(this.constructor===o)throw new Error("AbstractNumberField cannot be instantiated.");this._propertyNamesUsed={},this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"})}},enterDocument:{value:function(e){if(e){var t=this._propertyNamesUsed;t.min||(this.min=this.element.getAttribute("min")||this._min),t.max||(this.max=this.element.getAttribute("max")||this._max),t.step||(this.step=this.element.getAttribute("step")||this._step),t.value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this._numberFieldTextFieldComponent.addEventListener("action",this,!1),this._numberFieldMinusComponent.addEventListener("action",this,!1),this._numberFieldPlusComponent.addEventListener("action",this,!1),this._numberFieldTextFieldComponent.delegate=this,this.element.addEventListener("mousedown",this,!1),this.element.tabIndex="-1",this._upKeyComposer=n.createKey(this,"up","increase"),this._downKeyComposer=n.createKey(this,"down","decrease"),this._rightKeyComposer=n.createKey(this,"right","increase"),this._leftKeyComposer=n.createKey(this,"left","decrease")}}},textFieldShouldBeginEditing:{value:function(){return this.enabled}},textFieldDidChange:{value:function(){}},textFieldDidEndEditing:{value:function(){this.value=this._numberFieldTextFieldComponent.value}},textFieldShouldAcceptValue:{value:function(e,t){if(this._activeValueChange===!0)return!0}},prepareForActivationEvents:{value:function(){this._upKeyComposer.addEventListener("keyPress",this,!1),this._downKeyComposer.addEventListener("keyPress",this,!1),this._leftKeyComposer.addEventListener("keyPress",this,!1),this._rightKeyComposer.addEventListener("keyPress",this,!1)}},draw:{value:function(){this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleMousedown:{value:function(){this.element.focus()}},handlePlusAction:{value:function(){this._activeValueChange=!0;var e=this.step*this._stepDecimal,t="number"==typeof this.min?this.min*this._stepDecimal:0,i=this.value*this._stepDecimal-t;i%e?i<0?i-=i%e:i+=e-i%e:i+=e,this.value=(i+t)/this._stepDecimal,this._activeValueChange=!1}},handleMinusAction:{value:function(){this._activeValueChange=!0;var e=this.step*this._stepDecimal,t="number"==typeof this.min?this.min*this._stepDecimal:0,i=this.value*this._stepDecimal-t;i-=i%e?i>0?i%e:e+i%e:e,this.value=(i+t)/this._stepDecimal,this._activeValueChange=!1}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this.handlePlusAction():"decrease"===e.identifier&&this.handleMinusAction())}},handleAction:{value:function(e){e.target!==this._numberFieldTextFieldComponent&&e.target!==this._numberFieldMinusComponent&&e.target!==this._numberFieldPlusComponent||(e.stopPropagation(),this.dispatchActionEvent())}},_value:{value:0},_required:{value:!1},_min:{value:"any"},_max:{value:"any"},_step:{value:1},min:{get:function(){return this._min},set:function(e){return("any"===e||!isNaN(e=parseFloat(e)))&&void(this._min!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.min=!0),this._min=e,this.needsDraw=!0,"number"==typeof e&&this.value<e&&(this.value=e)))}},max:{get:function(){return this._max},set:function(e){return("any"===e||!isNaN(e=parseFloat(e)))&&void(this._max!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.max=!0),this._max=e,this.needsDraw=!0,"number"==typeof e&&this.value>e&&(this.value=e)))}},_stepDecimal:{value:1},step:{get:function(){return this._step},set:function(e){if(isNaN(e=parseFloat(e))||e<=0)return!1;if(this._step!==e){this._propertyNamesUsed&&(this._propertyNamesUsed.step=!0),this._step=e;var t=String(e).match(/\.(\d+)$/);t?this._stepDecimal=Math.pow(10,t[1].length):this._stepDecimal=1}}},value:{get:function(){return this._value},set:function(e){null===e||void 0===e||"undefined"==typeof e.valueOf?this._value="":isNaN(e=parseFloat(e))||("number"==typeof this.min&&e<this.min&&(e=this.min),"number"==typeof this.max&&e>this.max&&(e=this.max),this._value!==e&&(this._propertyNamesUsed&&(this._propertyNamesUsed.value=!0),this._value=e,this.needsDraw=!0)),this._numberFieldTextFieldComponent&&this._value!==this._numberFieldTextFieldComponent.value&&(this._numberFieldTextFieldComponent.value=this._value)}},enabled:{value:!0},_numberFieldTextFieldComponent:{value:null},_numberFieldMinusComponent:{value:null},_numberFieldPlusComponent:{value:null},_activeValueChange:{value:!1}})}}),montageDefine("b7b5e36","core/meta/model",{dependencies:["../core","./model-group","./object-descriptor","../deprecate","../application","../core","../core","../core","../core"],factory:function(e,t,i){var r=e("../core").Montage,n=e("./model-group").ModelGroup,o=e("./object-descriptor"),a=e("../deprecate"),s=e("../application").application,l=null,u=t.Model=r.specialize({constructor:{value:function(){return this._name=null,this.modelModuleId=null,this.isDefault=!1,this._objectDescriptorForPrototypeTable={},this}},initWithNameAndRequire:{value:function(e,t){if(!e)throw new Error("name is required");if(!t)throw new Error("require is required");return this._name=e,this._require=t,u.group.addModel(this),this}},serializeSelf:{value:function(e){this.version>1&&e.setProperty("version",this.version),e.setProperty("name",this.name),this.objectDescriptors.length>0&&e.setProperty("objectDescriptors",this.objectDescriptors),e.setProperty("objectModelModuleId",this.modelInstanceModuleId)}},deserializeSelf:{value:function(e){var t=e.getProperty("version");void 0!==t&&(this.version=t),t=e.getProperty("name"),void 0!==t&&(this._name=t),t=e.getProperty("objectDescriptors")||e.getProperty("blueprints"),t&&(this._objectDescriptors=t),t=e.getProperty("objectModelModuleId")||e.getProperty("binderModuleId"),void 0!==t&&(this.modelInstanceModuleId=t)}},_name:{value:null},name:{get:function(){return this._name}},_require:{value:null},require:{get:function(){return this._require}},_objectDescriptorForPrototypeTable:{value:null},identifier:{get:function(){return["objectModel",this.name.toLowerCase()].join("_")}},modelInstanceModuleId:{serializable:!1,value:null},isDefault:{serializable:!1,value:!1},_objectDescriptors:{value:null},objectDescriptors:{get:function(){return this._objectDescriptors||(this._objectDescriptors=[])}},addObjectDescriptor:{value:function(e){if(null!==e){var t=this.objectDescriptors.indexOf(e);t<0&&(null!==e.model&&e.model!==this&&e.model.removeObjectDescriptor(e),this.objectDescriptors.push(e),e.model=this)}return e}},removeObjectDescriptor:{value:function(e){if(null!==e){var t=this.objectDescriptors.indexOf(e);t>=0&&(this.objectDescriptors.splice(t,1),e.model=null)}return e}},addObjectDescriptorNamed:{value:function(e){return this.addObjectDescriptor((new o.ObjectDescriptor).initWithName(e))}},objectDescriptorForPrototype:{value:a.deprecateMethod(void 0,function(e){return this.objectDescriptorForName(e)},"objectDescriptorForPrototype","objectDescriptorForName")},objectDescriptorForName:{value:function(e){for(var t=this.objectDescriptors,i=null,r=t.length,n=0;n<r&&!i;n++)t[n].name===e&&(i=t[n]);return i}},_objectDescriptorObjectProperty:{value:null},ObjectProperty:{get:function(){return this._objectDescriptorObjectProperty||(this._objectDescriptorObjectProperty=u.group.defaultObjectDescriptorObjectProperty),this._objectDescriptorObjectProperty}},objectDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,objectDescriptor:e("../core")._objectDescriptorDescriptor,blueprints:{get:a.deprecateMethod(void 0,function(){return this.objectDescriptors},"blueprints","objectDescriptors")},addBlueprint:{value:a.deprecateMethod(void 0,function(e){return this.addObjectDescriptor(e)},"addBlueprint","addObjectDescriptor")},removeBlueprint:{value:a.deprecateMethod(void 0,function(e){return this.removeObjectDescriptor(e)},"removeBlueprint","removeObjectDescriptor")},addBlueprintNamed:{value:a.deprecateMethod(void 0,function(e){return this.addObjectDescriptorNamed(e)},"addBlueprintNamed","addObjectDescriptorNamed")},blueprintForPrototype:{value:a.deprecateMethod(void 0,function(e){return this.blueprintForName(e)},"blueprintForPrototype","blueprintForName")},blueprintForName:{value:a.deprecateMethod(void 0,function(e){return this.objectDescriptorForName(e)},"blueprintForName","objectDescriptorForName")},blueprintModuleId:e("../core")._objectDescriptorModuleIdDescriptor,blueprint:e("../core")._objectDescriptorDescriptor},{group:{get:function(){return null===l&&(l=new n,l.name=s?s.name:""),l}},manager:{get:a.deprecateMethod(void 0,function(){return t.Model.group},"Binder.manager","Model.group")}})}}),montageDefine("cf0fb3f","ui/slider.reel/slider.html",{
text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Slider{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;width:10em;height:.625em;border-radius:.25em;border:1px solid;outline:none;padding-right:-webkit-calc(1.75em - 2px);padding-right:-moz-calc(1.75em - 2px);padding-right:calc(1.75em - 2px)}.digit-Slider.montage-Slider--vertical{width:.625em;height:10em;margin:0 .625em;padding-right:0;padding-bottom:-webkit-calc(1.75em - 2px);padding-bottom:-moz-calc(1.75em - 2px);padding-bottom:calc(1.75em - 2px)}.digit-Slider-thumb{position:relative;font-size:inherit;-moz-box-sizing:border-box;box-sizing:border-box;width:1.75em;height:1.75em;margin:-.625em 0 0 -1px;border-radius:.875em;border:1px solid;background-color:currentColor;cursor:pointer}.montage-Slider--vertical .digit-Slider-thumb{margin:-1px 0 0 -.625em}.digit-Slider-thumb:after{position:absolute;content:"";top:-16px;left:-16px;bottom:-16px;right:-16px}[data-montage-skin="wireframe"] .digit-Slider{border-color:#b3b3b3;background-color:#d9d9d9}[data-montage-skin="wireframe"] .digit-Slider-thumb{border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .montage-Slider--active .digit-Slider-thumb{background-color:#e5e5e5}[data-montage-skin="light"] .digit-Slider{border-color:hsla(0,0%,70%,1);background-color:hsl(0,0%,86%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Slider-thumb{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-moz-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-ms-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.1),0 7px 6px -3px hsla(0,0%,0%,.15)}[data-montage-skin="light"] .montage-Slider--active .digit-Slider-thumb{border-color:hsla(0,0%,65%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.2),0 6px 6px -3px hsla(0,0%,0%,.1)}[data-montage-skin="dark"] .digit-Slider{border-color:hsl(0,0%,15%);background-color:hsl(0,0%,22%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.25),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-Slider-thumb{border-color:hsl(0,0%,16%);background-image:-webkit-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.15),0 7px 6px -3px hsla(0,0%,0%,.25)}[data-montage-skin="dark"] .montage-Slider--active .digit-Slider-thumb{border-color:hsl(0,0%,12%);background-image:-webkit-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-moz-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-ms-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.2),0 7px 6px -3px hsla(0,0%,0%,.15)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"slider"},"_sliderThumbElement":{"#":"sliderThumb"}}}}</script></head><body><div data-montage-id=slider class=digit-Slider><div data-montage-id=sliderThumb class=digit-Slider-thumb></div></div></body></html>'}),montageDefine("cf0fb3f","ui/button.reel/button.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Button{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;height:2.5em;min-width:2.5em;margin:0 2px;padding:.625em 1em;border-radius:1.25em;vertical-align:middle;font-size:100%;color:inherit;border:1px solid;background-color:transparent;outline:none;cursor:pointer;text-decoration:none;-webkit-tap-highlight-color:transparent}.digit-Button.montage--active{background-color:hsla(0,0%,0%,.06)}.digit-Button:focus{box-shadow:inset 0 0 0 1px}[data-montage-skin="wireframe"] .digit-Button{color:#4D4D4D;border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .digit-Button.montage--active{background-color:#e5e5e5}[data-montage-skin="wireframe"] .digit-Button:focus{border-color:#4D4D4D;box-shadow:none}[data-montage-skin="light"] .digit-Button{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),inset 0 -1px 1px hsla(0,0%,0%,.04),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Button.montage--active{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-moz-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-ms-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.2),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-Button:focus{border-color:hsl(0,0%,50%)}[data-montage-skin="dark"] .digit-Button{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),inset 0 -1px 1px hsla(0,0%,0%,.06),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button.montage--active{color:hsl(0,0%,60%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-moz-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-ms-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button:focus{border-color:hsl(0,0%,50%)}.digit-Button--glass,.digit-Button--glass.montage--active,[data-montage-skin="wireframe"] .digit-Button--glass,[data-montage-skin="wireframe"] .digit-Button--glass.montage--active,[data-montage-skin="light"] .digit-Button--glass,[data-montage-skin="light"] .digit-Button--glass.montage--active,[data-montage-skin="dark"] .digit-Button--glass,[data-montage-skin="dark"] .digit-Button--glass.montage--active{margin:0;border-radius:0;border:none;background:0 0;box-shadow:none}[data-montage-skin="dark"] .digit-Button--glass.montage--active{color:hsla(0,0%,100%,.5)}.digit-ButtonGroup{display:inline-block;vertical-align:middle;padding-left:1px;border-radius:1.25em}.digit-ButtonGroup>.digit-Button{float:left;margin:0 0 0 -1px;border-radius:0}.digit-ButtonGroup>.digit-Button:first-child{border-top-left-radius:inherit;border-bottom-left-radius:inherit}.digit-ButtonGroup>.digit-Button:last-child{border-top-right-radius:inherit;border-bottom-right-radius:inherit}</style></head><body></body></html>'}),montageDefine("cf0fb3f","ui/text-field.reel/text-field.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-TextField{outline:none;box-sizing:border-box;font-size:100%;width:10em;height:2.5em;padding:0 .5em;vertical-align:middle;color:inherit;border:1px solid;border-radius:.25em;background-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-appearance:none}.digit-TextField:focus{box-shadow:inset 0 0 0 1px}.digit-TextField.montage--disabled{opacity:.5;border-style:dashed;pointer-events:none}.digit-TextField:invalid{color:#E73525}.digit-TextField[readonly]{background-color:#e5e5e5}.digit-TextField::-webkit-input-placeholder{color:inherit;opacity:.5}.digit-TextField::-moz-placeholder{color:inherit;opacity:.5}.digit-TextField:-ms-input-placeholder{color:inherit;opacity:.5}[data-montage-skin="wireframe"] .digit-TextField{color:#4D4D4D;border-color:#b3b3b3;background-color:#fff}[data-montage-skin="wireframe"] .digit-TextField:focus{border-color:#7f7f7f;box-shadow:none}[data-montage-skin="wireframe"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="light"] .digit-TextField{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.05),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-TextField:focus{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-moz-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-ms-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="dark"] .digit-TextField{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-moz-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-ms-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-TextField:focus{color:hsl(0,0%,100%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-moz-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-ms-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-TextField:invalid{color:#FF6052;border-color:#FF6052}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"textField"}}}}</script></head><body><input data-montage-id=textField class=digit-TextField></body></html>'}),montageDefine("b7b5e36","ui/base/abstract-button",{dependencies:["./abstract-control","../../composer/press-composer"],factory:function(e,t,i){var r=e("./abstract-control").AbstractControl,n=e("../../composer/press-composer").PressComposer;t.AbstractButton=r.specialize({constructor:{value:function o(){if(this.constructor===o)throw new Error("AbstractButton cannot be instantiated.");this._pressComposer=new n,this.addComposer(this._pressComposer),this._pressComposer.defineBinding("longPressThreshold ",{"<-":"holdThreshold",source:this}),this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage--active')",{"<-":"active"})}},enabled:{value:!0},_preventFocus:{value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){this._preventFocus=!!e,this.needsDraw=!0}},acceptsActiveTarget:{value:function(){return!this._preventFocus}},willBecomeActiveTarget:{value:function(e){}},_labelNode:{value:void 0,enumerable:!1},_label:{value:void 0,enumerable:!1},label:{get:function(){return this._label},set:function(e){if("undefined"!=typeof e&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=""+e,this.needsDraw=!0}},holdThreshold:{value:1e3},_pressComposer:{value:null},_active:{value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,i){r.prototype.addEventListener.call(this,e,t,i),"longAction"===e&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(e){this.active=!1,this.dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){32===e.keyCode&&(this.active=!1,this.dispatchActionEvent())}},handleLongPress:{value:function(e){this._pressComposer.cancelPress();var t=document.createEvent("CustomEvent");t.initCustomEvent("longAction",!0,!0,null),this.dispatchEvent(t)}},handlePressCancel:{value:function(e){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},isInputElement:{value:!1},enterDocument:{value:function(e){e&&(this.isInputElement="INPUT"===this.originalElement.tagName,this.isInputElement?void 0===this._label&&(this.label=this.originalElement.value):(this.originalElement.firstChild||this.originalElement.appendChild(document.createTextNode("")),this._labelNode=this.originalElement.firstChild,void 0===this._label&&(this.label=this._labelNode.data)),this.element.setAttribute("role","button"),this.element.addEventListener("keyup",this,!1))}},_drawLabel:{enumerable:!1,value:function(e){this.isInputElement?this._element.value=e:this._labelNode&&(this._labelNode.data=e)}},draw:{value:function(){this._elementNeedsTabIndex()&&(this._preventFocus?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex","-1")),this.isInputElement&&(this.element.disabled=!this.enabled),this._drawLabel(this.label)}},_elementNeedsTabIndexRegex:{value:/INPUT|TEXTAREA|A|SELECT|BUTTON|LABEL/},_elementNeedsTabIndex:{value:function(){return null===this.element.tagName.match(this._elementNeedsTabIndexRegex)}}})}}),montageDefine("b7b5e36","ui/base/abstract-text-field",{dependencies:["./abstract-control","../../composer/key-composer","../../core/deprecate"],factory:function(e,t,i){var r=e("./abstract-control").AbstractControl,n=e("../../composer/key-composer").KeyComposer,o=e("../../core/deprecate");t.AbstractTextField=r.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractTextField cannot be instantiated.");this.defineBindings({"classList.has('montage--disabled')":{"<-":"!enabled"}})}},hasTemplate:{value:!1},acceptsActiveTarget:{get:function(){return this.callDelegateMethod("shouldBeginEditing",this)!==!1}},delegate:{value:null},enabled:{value:!0},_placeholder:{value:null},placeholderValue:{set:function(e){o.deprecationWarning("placeholderValue","placeholder"),this.placeholder=e},get:function(){return this.placeholder}},placeholder:{set:function(e){this._placeholder=e,this.needsDraw=!0},get:function(){return this._placeholder}},_value:{value:null},value:{set:function(e){e!==this._value&&(this.hasFocus&&!this.callDelegateMethod("shouldAcceptValue",this,e)||(this._value=e,this.needsDraw=!0))},get:function(){return this._value}},errorMessage:{value:null},converter:{value:null},_hasFocus:{value:!1},hasFocus:{set:function(e){this._hasFocus=e},get:function(){return this._hasFocus}},__keyComposer:{value:null},_keyComposer:{get:function(){return this.__keyComposer||(this.__keyComposer=new n,this.__keyComposer.component=this,this.__keyComposer.keys="enter",this.addComposer(this.__keyComposer)),this.__keyComposer}},handleKeyPress:{value:function(e){this.enabled&&e.keyComposer===this._keyComposer&&this.dispatchActionEvent()}},prepareForActivationEvents:{value:function(){this._keyComposer.addEventListener("keyPress",this,!1)}},enterDocument:{value:function(e){e&&(this.element.addEventListener("input",this,!1),this.element.addEventListener("change",this,!1))}},draw:{value:function(){var e,t=this.value,i=this.element.selectionStart,r=this.element.selectionEnd;this.converter&&(t=this.converter.convert(t)),e=typeof t,null===t||"undefined"===e?this.element.value="":"boolean"===e||"object"===e||"number"===e?this.element.value=t.toString():this.element.value=t,this.eventManager.activeTarget===this&&"function"==typeof this.element.setSelectionRange&&this.element.setSelectionRange(i,r),this._placeholder&&this.element.setAttribute("placeholder",this._placeholder),this.element.disabled=!this.enabled}},handleChange:{value:function(){this._updateValueFromDom()}},handleInput:{value:function(e){this._updateValueFromDom()}},willBecomeActiveTarget:{value:function(e){this.hasFocus=!0,this.callDelegateMethod("didBeginEditing",this)}},surrendersActiveTarget:{value:function(e){return this.callDelegateMethod("shouldEndEditing",this)!==!1&&(this._hasFocus=!1,this.callDelegateMethod("didEndEditing",this),!0)}},_updateValueFromDom:{value:function(){var e,t;if(t=e=this.element.value,this.converter)try{t=this.converter.revert(e),this.errorMessage=null}catch(i){this.errorMessage=i.message||i}this._value!==t&&(this._value=t,this.dispatchOwnPropertyChange("value",this._value),this.callDelegateMethod("didChange",this)),this.converter&&(this.needsDraw=!0)}}})}}),montageDefine("b7b5e36","data/model/enumeration",{dependencies:["core/core"],factory:function(e,t,i){var r=e("core/core").Montage;t.Enumeration=r.specialize({},{specialize:{value:function(e,t,i,r,n){return this._specialize(this._parseSpecializeArguments.apply(this,arguments))}},getterFor:{value:function(e,i,r,n,o,a){var s=this._parseSpecializeArguments.apply(this,Array.prototype.slice.call(arguments,1));return function(){return this.hasOwnProperty(e)||(this[e]=t.Enumeration._specialize(s)),this[e]}}},_parseSpecializeArguments:{value:function(){var e,t,i,r,n,o;for(e=0,Array.isArray(arguments[e])?t=arguments[e]:"string"==typeof arguments[e]&&arguments[e].length>0?t=[arguments[e]]:null===arguments[e]||void 0===arguments[e]||""===arguments[e]?t=[]:(t=[],e-=1),i=Array.isArray(arguments[e+1])&&arguments[e+1],n=e+1,o=arguments.length;!i;n+=1)n!==o&&arguments[n]&&"string"==typeof arguments[n]||(i=Array.prototype.slice.call(arguments,e+1,n),e=n-2);return r=Math.min(arguments.length,e+5),{uniquePropertyNames:t,otherPropertyNames:i,prototypeDescriptor:r>e+3?arguments[e+2]:{},constructorDescriptor:r>e+4?arguments[e+3]:{},constantDescriptors:r>e+2?arguments[r-1]:{}}}},_specialize:{value:function(e){var i,n,o,a,s,l=e.uniquePropertyNames,u=e.otherPropertyNames,c=e.prototypeDescriptor,h=e.constructorDescriptor,d=e.constantDescriptors;for(this._addPropertiesToDescriptor(c,l,u),this._addLookupFunctionsToDescriptor(h,l),this._addConstructorFunctionToDescriptor(h,l,[]),u.length&&this._addConstructorFunctionToDescriptor(h,l,u),i=r.specialize.call(t.Enumeration,c,h),n=this._makeCreateFunction(l,u),a=Object.keys(d),o=0;s=a[o];++o)i[s]=n.apply(i,d[s]);return i}},_addPropertiesToDescriptor:{value:function(e,t,i){var r,n;for(r=0,n=t.length;r<n;r+=1)e[t[r]]||(e[t[r]]={value:void 0});for(r=0,n=i.length;r<n;r+=1)e[i[r]]||(e[i[r]]={value:void 0})}},_addLookupFunctionsToDescriptor:{value:function(e,t){var i,r,n,o;for(n=0,o=t.length;n<o;n+=1)i="for"+t[n][0].toUpperCase()+t[n].slice(1),r=this._makeLookupFunction(t[n]),e[i]={value:r}}},_makeLookupFunction:{value:function(e){return function(t){return this._instances&&this._instances[e]&&this._instances[e][t]}}},_addConstructorFunctionToDescriptor:{value:function(e,t,i){var r,n,o,a;if(t.length||i.length){for(r=this._makeCreateFunction(t,i),n=["with"],o=0,a=t.length;o<a;o+=1)n.push(t[o][0].toUpperCase()),n.push(t[o].slice(1));for(o=0,a=i.length;o<a;o+=1)n.push(i[o][0].toUpperCase()),n.push(i[o].slice(1));n.length>3&&n.splice(n.length-2,0,"And"),e[n.join("")]={value:r}}}},_makeCreateFunction:{value:function(e,t){var i=this;return function(r,n){var o=i._parseCreateArguments(e,t,arguments);return i._create(this,e,t,o)}}},_parseCreateArguments:{value:function(e,t,i){var r=e.length+t.length;return{propertyValues:Array.prototype.slice.call(i,0,r),propertyDescriptors:i[r]||{}}}},_create:{value:function(e,t,i,n){var o,a,s,l,u;for(o=new e,r.defineProperties(o,n.propertyDescriptors),s=0,u=t.length,l=i.length;s<u+l;s+=1)a=s<u?t[s]:i[s-u],o[a]=n.propertyValues[s];for(s=0,u=t.length;s<u;s+=1)e._instances=e._instances||{},e._instances[t[s]]=e._instances[t[s]]||{},e._instances[t[s]][n.propertyValues[s]]=o;return o}}})}}),montageDefine("b7b5e36","core/criteria",{dependencies:["./core","frb/parse","frb/stringify","frb/evaluate","frb/language","frb/scope","frb/compile-evaluator"],factory:function(e,t,i){var r=e("./core").Montage,n=e("frb/parse"),o=e("frb/stringify"),a=(e("frb/evaluate"),e("frb/language").precedence),s=e("frb/scope"),l=e("frb/compile-evaluator"),u=t.Criteria=r.specialize({_expression:{value:null},expression:{get:function(){return this._expression}},parameters:{value:null},_syntax:{value:null},syntax:{get:function(){return this._syntax||(this._syntax=n(this._expression))}},_compiledSyntax:{value:null},compiledSyntax:{get:function(){return this._compiledSyntax||(this._compiledSyntax=l(this.syntax))}},initWithSyntax:{value:function(e,t){return this._syntax=e,this.parameters=t,this}},initWithExpression:{value:function(e,t){return this._expression=e,this.parameters=t,this}},initWithPath:{value:function(e){return this.initWithExpression(e)}},criteriaWithParameters:{value:function(e){var t=(new this.constructor).initWithExpression(this.expression);return t.parameters=e,t}},serializeSelf:{value:function(e){e.setProperty("expression",this._expression||(this._expression=o(this.syntax))),e.setProperty("parameters",this.parameters)}},deserializeSelf:{value:function(e){var t;t=e.getProperty("expression")||e.getProperty("path"),void 0!==t&&(this._expression=t),t=e.getProperty("parameters"),void 0!==t&&(this.parameters=t)}},__scope:{value:null},_scope:{get:function(){return this.__scope||(this.__scope=new s)}},evaluate:{value:function(e,t){return this._scope.parameters=t||this.parameters,this._scope.value=e,this.compiledSyntax(this._scope)}}},{forObjectsLike:{value:function(e){var t,i,r,n,o,a,s,l=Object.keys(e),u="";for(t=0;i=l[t];t++)if(r=e[i],Array.isArray(r)){for(a="",n=0;o=r[n];n++)s=i,s+=n,a.length>0&&(a+=" && "),a+=i,a+=".has($",a+=s,a+=")",e[s]=o;u.length>0&&(u+=" && "),u+=a}else u.length>0&&(u+=" && "),u+=i,u+="== $",u+=i;return(new this).initWithExpression(u,e)}},withExpression:{value:function(e,t){return(new this).initWithExpression(e,t)}},withSyntax:{value:function(e,t){return(new this).initWithSyntax(e,t)}}});a.forEach(function(e,t,i){r.defineProperty(u.prototype,t,{value:function(){var e=Array.prototype.map.call(arguments,function(e){return"string"==typeof e?n(e):e.syntax?e.syntax:"object"==typeof e?e:void 0});return(new this.constructor).initWithSyntax({type:t,args:[this.syntax].concat(e)})}}),r.defineProperty(u,t,{value:function(){var e=Array.prototype.map.call(arguments,function(e){return"string"==typeof e?n(e):e.syntax?e.syntax:"object"==typeof e?e:void 0});return(new this).initWithSyntax({type:t,args:e})}})})}}),montageDefine("b7b5e36","core/meta/model-group",{dependencies:["../core","./model","./object-property","../deprecate"],factory:function(e,t,i){var r=e("../core").Montage,n=e("./model"),o=e("./object-property").ObjectProperty,a=e("../deprecate");t.ModelGroup=r.specialize({constructor:{value:function(){this._models=[],this._modelTable={}}},_name:{value:null},name:{get:function(){return this._name},set:function(e){e!==this._name&&(this._name=e)}},_models:{value:null},_modelTable:{value:null},models:{get:function(){return this._models}},addModel:{value:function(e){var t;null!==e&&(this._modelTable[e.name]&&this.removeModel(this._modelTable[e.name]),t=this._models.indexOf(e),t>=0&&this._models.splice(t,1),this._models.push(e),this._modelTable[e.name]=e)}},removeModel:{value:function(e){var t;null!==e&&(t=this._models.indexOf(e),t>=0&&this._models.splice(t,1),this._modelTable[e.name]&&delete this._modelTable[e.name])}},modelForName:{value:function(e){return this._modelTable[e]}},objectDescriptorForPrototype:{value:function(e,t){var i,r,n=null;for(r=0;"undefined"!=typeof(i=this.models[r])&&!n;r++)n=i.objectDescriptorForName(e);return n}},_defaultObjectDescriptorObjectProperty:{serializable:!0,value:null},defaultObjectDescriptorObjectProperty:{get:function(){return this._defaultObjectDescriptorObjectProperty||(this._defaultObjectDescriptorObjectProperty=(new o).init()),this._defaultObjectDescriptorObjectProperty}},_defaultModel:{serializable:!0,value:null},defaultModel:{get:function(){if(!this._defaultModel){var t=global.mr||e;this._defaultModel=(new n.Model).initWithNameAndRequire("default",t),this._defaultModel.isDefault=!0,this.addModel(this._defaultModel)}return this._defaultModel}},binders:{get:a.deprecateMethod(void 0,function(){return this.models},"binders","models")},addBinder:{value:a.deprecateMethod(void 0,function(e){this.addModel(e)},"addBinder","addModel")},removeBinder:{value:a.deprecateMethod(void 0,function(e){return this.removeModel(e)},"removeBinder","removeModel")},binderForName:{value:a.deprecateMethod(void 0,function(e){return this.modelForName(e)},"binderForName","modelForName")},blueprintForPrototype:{value:a.deprecateMethod(void 0,function(e,t){return this.objectDescriptorForPrototype(e)},"blueprintForPrototype","objectDescriptorForPrototype")},defaultBlueprintObjectProperty:{get:a.deprecateMethod(void 0,function(){return this.defaultObjectDescriptorObjectProperty},"defaultBlueprintObjectProperty","defaultObjectDescriptorObjectProperty")},defaultBinder:{get:a.deprecateMethod(void 0,function(){return this.defaultModel},"defaultBinder","defaultModel")}})}}),montageDefine("b7b5e36","composer/key-composer",{dependencies:["../core/core","./composer"],factory:function(e,t,i){var r=e("../core/core").Montage,n=e("./composer").Composer,o=null,a=r.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},registerKey:{value:function(t){var i=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(t):(this._keysToRegister.push(t),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var t=i._defaultKeyManager=e.defaultKeyManager;i._keysToRegister.forEach(function(e){t.registerKey(e)}),i._keysToRegister.length=0})))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return o||(o=new a),this._defaultKeyManager?this._defaultKeyManager:o}}}),s="keyPress",l="longKeyPress",u="keyRelease",c=t.KeyComposer=n.specialize({_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(a.defaultKeyManager.unregisterKey(this),this._keys=e,a.defaultKeyManager.registerKey(this)):this._keys=e}},load:{value:function(){this._shouldDispatchEvent&&!this._keyRegistered&&(a.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){a.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,t,i){var r=this.component;n.prototype.addEventListener.call(this,e,t,i),e!==s&&e!==l&&e!==u||(this._shouldDispatchEvent=!0,e===l&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(a.defaultKeyManager.registerKey(this),this._keyRegistered=!0):r&&"function"!=typeof r.addComposer&&(this.element||(this.element=window),this.component.loadComposer(this)))}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=r.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.component.loadComposer(this)))}}},{createKey:{value:function(e,t,i){var r=this;return this===c&&(r=new c),i||(i=e.identifier?e.identifier+t.toLowerCase().replace(/[ +]/g).toCapitalized():t.toLowerCase().replace(/[ +]/g)),r.keys=t,r.identifier=i,e.addComposer(r),r}},createGlobalKey:{value:function(e,t,i){var r=this;return this===c&&(r=new c),r.keys=t,r.identifier=i,e.addComposerForElement(r,window),r}}})}}),montageDefine("b7b5e36","data/service/data-stream",{dependencies:["data/service/data-provider","data/model/data-object-descriptor","data/model/data-query","core/promise","core/deprecate","frb/parse","frb/scope","frb/compile-evaluator"],factory:function(e,t,i){var r=e("data/service/data-provider").DataProvider,n=e("data/model/data-object-descriptor").DataObjectDescriptor,o=e("data/model/data-query").DataQuery,a=e("core/promise").Promise,s=e("core/deprecate"),l=e("frb/parse"),u=e("frb/scope"),c=e("frb/compile-evaluator");t.DataStream=r.specialize({query:{value:void 0},selector:{get:s.deprecateMethod(void 0,function(){return this.query},"selector","query"),set:s.deprecateMethod(void 0,function(e){this.query=e},"selector","query")},data:{get:function(){return this._data||(this._data=[]),this._data}},requestData:{value:function(e,t){return this}},_resolve:{value:function(e){this.__promise||(this.__promise=a.resolve(e))}},_reject:{value:function(e){this.__promise||(this.__promise=function(){return a.reject(e)})}},_promise:{get:function(){var e=this;return"function"==typeof this.__promise?this.__promise=this.__promise():this.__promise||(this.__promise=new a(function(t,i){e._resolve=t,e._reject=i})),this.__promise}},then:{value:function(e,t){return this._promise.then(e,t)}},"catch":{value:function(e){return this._promise["catch"](e)}},addData:{value:function(e){var t=e;this.dataExpression&&e&&(t=this._compiledDataExpression(new u(e))),t&&Array.isArray(t)?this.data.push.apply(this.data,t):t&&this.data.push(t)}},dataDone:{value:function(){this._resolve(this.data),delete this._resolve,delete this._reject}},dataError:{value:function(e){this._reject(e),delete this._reject,delete this._resolve}},_compiledDataExpression:{get:function(){return this.__compiledDataExpression||(this.__compiledDataExpression=c(this._dataExpressionSyntax))}},_dataExpressionSyntax:{get:function(){return this.__dataExpressionSyntax||(this.__dataExpressionSyntax=l(this.dataExpression))}},dataExpression:{value:void 0},evaluateDataExpression:{value:function(e){return this._compiledDataExpression(e)}},dataReceptionTime:{value:void 0},_dataMaxAge:{value:void 0},dataMaxAge:{get:function(){return this._dataMaxAge||this.query.type.maxAge},set:function(e){this._dataMaxAge=e}}},{withTypeOrSelector:{value:function(e){var t=e instanceof n&&e,i=t&&o.withTypeAndCriteria(t)||e,r=new this;return r.query=i,r}}})}}),montageDefine("b7b5e36","core/meta/validation-rule",{
dependencies:["../core","./validation-semantics","../selector","../deprecate","../core","../core","../core","../core"],factory:function(e,t,i){var r=e("../core").Montage,n=e("./validation-semantics").PropertyValidationSemantics,o=e("../selector").Selector,a=e("../deprecate");t.PropertyValidationRule=r.specialize({initWithNameAndObjectDescriptor:{value:function(e,t){return this._name=e,this._owner=t,this}},serializeSelf:{value:function(e){e.setProperty("name",this.name),e.setProperty("objectDescriptor",this.owner,"reference"),e.setProperty("messageKey",this.messageKey),e.setAllValues()}},deserializeSelf:{value:function(e){var t;t=e.getProperty("name"),void 0!==t&&(this._name=t),t=e.getProperty("objectDescriptor")||e.getProperty("blueprint"),void 0!==t&&(this._owner=t),t=e.getProperty("messageKey"),void 0!==t&&(this._messageKey=t);for(var i=r.getSerializablePropertyNames(this),n=0,o=i.length;n<o;n++){var a=i[n];this[a]=e.getProperty(a)}}},_owner:{value:null},owner:{get:function(){return this._owner}},identifier:{get:function(){return[this.objectDescriptor.identifier,"rule",this.name].join("_")}},_name:{value:""},name:{get:function(){return this._name}},_validationSelector:{value:null},validationSelector:{serializable:!1,get:function(){return this._validationSelector||(this._validationSelector=o["false"]),this._validationSelector},set:function(e){this._validationSelector=e}},_messageKey:{value:""},messageKey:{serializable:!1,get:function(){return this._messageKey&&0!==this._messageKey.length?this._messageKey:this._name},set:function(e){this._messageKey=e}},_propertyValidationEvaluator:{value:null},evaluateRule:{value:function(e){if(null===this._propertyValidationEvaluator){var t=(new n).initWithBlueprint(this.objectDescriptor);this._propertyValidationEvaluator=t.compile(this.selector.syntax)}return this._propertyValidationEvaluator(e)}},objectDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,objectDescriptor:e("../core")._objectDescriptorDescriptor,initWithNameAndBlueprint:{value:a.deprecateMethod(void 0,function(e,t){return this.initWithNameAndObjectDescriptor(e,t)},"initWithNameAndBlueprint","initWithNameAndObjectDescriptor")},blueprintModuleId:e("../core")._objectDescriptorModuleIdDescriptor,blueprint:e("../core")._objectDescriptorDescriptor})}}),montageDefine("cf0fb3f","package.json",{exports:{name:"digit",description:"Touch-optimized MontageJS components for tablets and phones.",version:"3.0.0",license:"BSD-3-Clause",repository:{type:"git",url:"git+https://github.com/montagejs/digit.git"},dependencies:{montage:"^17.0.7"},devDependencies:{concurrently:"^3.4.0","http-server":"^0.9.0","jasmine-console-reporter":"^1.2.7","jasmine-core":"^2.5.2",karma:"^1.5.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.0.1","karma-jasmine":"^1.1.0","karma-phantomjs-launcher":"^1.0.2","montage-testing":"git://github.com/montagejs/montage-testing.git#master",open:"0.0.5"},scripts:{test:"node test/run-node.js","test:karma":"karma start --no-auto-watch --single-run","test:karma-dev":"karma start --auto-watch --no-single-run","test:jasmine":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/test/run.html"',"start:demo":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/demo/sizing/index.html"',"start:overview":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/overview/index.html"'},exclude:["overview","test"],gitHead:"a46d7aa68cbf985e6f4b322096a1e2a022c14035",bugs:{url:"https://github.com/montagejs/digit/issues"},homepage:"https://github.com/montagejs/digit#readme",_id:"digit@3.0.0",_shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",_from:"digit@>=3.0.0 <4.0.0",_npmVersion:"2.15.11",_nodeVersion:"4.8.0",_npmUser:{name:"hthetiot",email:"hthetiot@gmail.com"},dist:{shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",tarball:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz"},maintainers:[{name:"francoisfrisch",email:"francoisfrisch@gmail.com"},{name:"hthetiot",email:"hthetiot@gmail.com"},{name:"marchant",email:"benoit@montagestudio.com"},{name:"montage-bot",email:"francoisfrisch@gmail.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/digit-3.0.0.tgz_1495575626923_0.7017284843605012"},directories:{},_resolved:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz",main:"index",hash:"cf0fb3f",mappings:{montage:{name:"montage",hash:"b7b5e36",location:"../montage@b7b5e36/"}},production:!0,useScriptInjection:!0}}),montageDefine("24e6f9c","ui/converter.reel/converter.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Converter{margin:20px auto;padding:20px;width:300px;border-radius:10px;background-color:hsl(0,0%,98%);box-shadow:inset 0 1px 2px 1px hsla(0,0%,100%,1),0 2px 5px hsla(0,0%,0%,.1)}.Converter:after{content:"";display:block;clear:both}.Numbers{float:left;border:none;margin:0;padding:0}.Label{margin:15px 0;line-height:40px;font-size:1.2em}.Label .digit-NumberField-input{width:70px;vertical-align:middle}.Slider{float:right;margin:0;padding:8px 4px;border-radius:100px;border:none;box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 2px 0 hsla(0,0%,100%,1);background:-webkit-linear-gradient(bottom,hsl(200,100%,50%),hsl(200,100%,80%)30%,hsl(60,100%,65%)50%,hsl(0,100%,80%)70%,hsl(0,100%,50%));background:linear-gradient(to top,hsl(200,100%,50%),hsl(200,100%,80%)30%,hsl(60,100%,65%)50%,hsl(0,100%,80%)70%,hsl(0,100%,50%))}.Slider-handle.digit-Slider.montage-Slider--vertical{height:120px}.Slider-handle.digit-Slider{background-color:transparent;border-color:transparent;box-shadow:none}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"owner"}}},"celsiusNumberfield":{"prototype":"digit/ui/number-field.reel","properties":{"element":{"#":"celsius"}},"bindings":{"value":{"<->":"(+@fahrenheitNumberfield.value - 32) / 1.8"}}},"fahrenheitNumberfield":{"prototype":"digit/ui/number-field.reel","properties":{"element":{"#":"fahrenheit"}},"bindings":{"value":{"<->":"@owner.weatherReport.temp"}}},"thermometer":{"prototype":"digit/ui/slider.reel","properties":{"element":{"#":"thermometer"},"axis":"vertical"},"bindings":{"value":{"<->":"@fahrenheitNumberfield.value"}}}}</script></head><body><div data-montage-id=owner class=Converter><fieldset class=Numbers><div class=Label>°C <input data-montage-id=celsius></div><div class=Label>°F <input data-montage-id=fahrenheit></div></fieldset><fieldset class=Slider><input data-montage-id=thermometer class=Slider-handle type=range min=-13 max=122></fieldset></div></body></html>'}),montageDefine("b7b5e36","core/meta/event-descriptor",{dependencies:["../core","../logger","../deprecate","../core","../core","../core","../core"],factory:function(e,t,i){var r=e("../core").Montage,n=(e("../logger").logger("objectDescriptor"),e("../deprecate")),o={name:"default",detailKeys:[],detailValueTypes:[],helpKey:""};t.EventDescriptor=r.specialize({constructor:{value:function(){this._detailKeys=[]}},initWithNameAndObjectDescriptor:{value:function(e,t){return this._name=null!==e?e:o.name,this._owner=t,this}},initWithNameAndBlueprint:{value:n.deprecateMethod(void 0,function(e,t){return this.initWithNameAndObjectDescriptor(e,t)},"new EventBlueprint().initWithNameAndBlueprint","new EventDescriptor().initWithNameAndObjectDescriptor")},serializeSelf:{value:function(e){e.setProperty("name",this.name),e.setProperty("objectDescriptor",this._owner,"reference"),this.detailKeys.length>0&&this._setPropertyWithDefaults(e,"detailKeys",this.detailKeys),this._setPropertyWithDefaults(e,"helpKey",this.helpKey)}},deserializeSelf:{value:function(e){var t;t=e.getProperty("name"),void 0!==t&&(this._name=t),t=e.getProperty("objectDescriptor")||e.getProperty("blueprint"),void 0!==t&&(this._owner=t),this.detailKeys=this._getPropertyWithDefaults(e,"detailKeys"),this.helpKey=this._getPropertyWithDefaults(e,"helpKey")}},_setPropertyWithDefaults:{value:function(e,t,i){i!==o[t]&&e.setProperty(t,i)}},_getPropertyWithDefaults:{value:function(e,t){var i=e.getProperty(t)||this[t];return i||this[t]||o[t]}},_owner:{value:null},owner:{get:function(){return this._owner}},_name:{value:null},name:{serializable:!1,get:function(){return this._name}},identifier:{get:function(){return[this.owner.identifier,this.name].join("_")}},_detailKeys:{value:null},detailKeys:{get:function(){return this._detailKeys},set:function(e){Array.isArray(e)&&(this._detailKeys=e)}},helpKey:{value:o.helpKey},objectDescriptorModuleId:e("../core")._objectDescriptorModuleIdDescriptor,objectDescriptor:e("../core")._objectDescriptorDescriptor,blueprintModuleId:e("../core")._blueprintModuleIdDescriptor,blueprint:e("../core")._blueprintDescriptor})}}),montageDefine("24e6f9c","logic/service/remote-data-service",{dependencies:["montage/data/service/http-service","montage/data/model/data-object-descriptor","montage/core/serialization/serializer/montage-serializer","montage/core/serialization/deserializer/montage-deserializer"],factory:function(e,t,i){var r=e("montage/data/service/http-service").HttpService,n=(e("montage/data/model/data-object-descriptor").DataObjectDescriptor,e("montage/core/serialization/serializer/montage-serializer").serialize),o=e("montage/core/serialization/deserializer/montage-deserializer").deserialize;t.RemoteDataService=r.specialize({ENDPOINT:{value:"https://localhost:8080"},fetchRawData:{value:function(e){return this.fetchRawDataWithQuery(e)}},mapFromRawData:{value:function(e,t,i){e.temp=t[0].temp}},fetchRawDataWithQuery:{value:function(e){var t=this,i=e.selector.criteria,r=e.selector.type,n=e.selector,o=t.ENDPOINT,a=this._getQuery(i,r,n);return o+="?query="+a,t.fetchHttpRawData(o,!1).then(function(r){r&&(t.addRawData(e,[r],i),t.rawDataDone(e))})}},fetchRawDataWithBody:{value:function(e){var t=this,i=e.selector.criteria,r=e.selector.type,n=e.selector,o=t.ENDPOINT,a=this._getQuery(i,r,n);return t.fetchHttpRawData(o,a,!1).then(function(r){r&&(t.addRawData(e,[r],i),t.rawDataDone(e))})}},fetchRawDataUsingParams:{value:function(e){var t=this,i=e.selector.criteria,r=e.selector.type,n=e.selector,o=t.ENDPOINT;return o+=this._getUrlQueryParams(i,r,n),t.fetchHttpRawData(o,!1).then(function(r){r&&(t.addRawData(e,[r],i),t.rawDataDone(e))})}},_getQuery:{value:function(t,i,r){var a=n(r,e);return o(a,e).then(function(e){}),encodeURIComponent(a)}},_getUrlQueryParams:{value:function(t,i,r){var o=i._montage_metadata.module,a=i._montage_metadata.property;return n(r,e),"?parameters="+encodeURIComponent(JSON.stringify(t.parameters))+"&module="+encodeURIComponent(o)+"&moduleName="+encodeURIComponent(a)+"&expression="+encodeURIComponent(t.expression)}}})}}),montageDefine("cf0fb3f","ui/number-field.reel/number-field.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-NumberField{box-sizing:border-box;position:relative;display:inline-block;width:auto;margin:0 4px;vertical-align:middle;outline:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.digit-NumberField>.digit-NumberField-input{float:left;width:3.75em;border-radius:0;text-align:center}.digit-NumberField>.digit-NumberField-plus,.digit-NumberField>.digit-NumberField-minus{float:left;margin:0;padding:2px;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.digit-NumberField>.digit-NumberField-plus{border-width:1px 1px 1px 0;border-radius:0 2.5em 2.5em 0}.digit-NumberField>.digit-NumberField-minus{border-width:1px 0 1px 1px;border-radius:2.5em 0 0 2.5em}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"numberField"},"_numberFieldTextFieldComponent":{"@":"textField"},"_numberFieldMinusComponent":{"@":"minus"},"_numberFieldPlusComponent":{"@":"plus"}}},"textField":{"prototype":"ui/text-field.reel","properties":{"element":{"#":"textField"}},"bindings":{"value":{"<->":"@owner.value"}}},"plus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonPlus"}}},"minus":{"prototype":"ui/button.reel","properties":{"element":{"#":"buttonMinus"}}}}</script></head><body><span data-montage-id=numberField class=digit-NumberField><button data-montage-id=buttonMinus class=digit-NumberField-minus tabindex=-1>−</button> <input data-montage-id=textField class=digit-NumberField-input> <button data-montage-id=buttonPlus class=digit-NumberField-plus tabindex=-1>+</button></span></body></html>'}),montageDefine("b7b5e36","data/model/data-object-descriptor",{dependencies:["./object-descriptor","./data-property-descriptor"],factory:function(e,t,i){var r=e("./object-descriptor").ObjectDescriptor,n=e("./data-property-descriptor").DataPropertyDescriptor;t.DataObjectDescriptor=r.specialize({identifierNames:{value:[]},propertyDescriptors:{get:function(){return Object.getOwnPropertyDescriptor(r.prototype,"propertyDescriptors").get.call(this)}},setPropertyDescriptor:{value:function(e,t){r.prototype.setPropertyDescriptor.call(this,e,t)}},makePropertyDescriptor:{value:function(){return new n}},_addRelationships:{value:function(e){var t,i,r;if(e)for(t=Object.keys(e),i=0,r=t.length;i<r;i+=1)this._addRelationship(t[i],e[t[i]])}},_addRelationship:{value:function(e,t){this.propertyDescriptors[e]||this.setPropertyDescriptor(e,this.makePropertyDescriptor()),this.propertyDescriptors[e].isRelationship=!0,this.propertyDescriptors[e].isGlobal=!!t.isGlobal}}},{getterFor:{value:function(e,t,i,n,o){var a=this._parseGetterForArguments.apply(this,arguments),s=r.getterFor.call(this,a.exports,a.name,a.types);return function(){return this.hasOwnProperty("_TYPE")||(this._TYPE=s.call(this),this._TYPE.identifierNames=a.identifiers,this._TYPE._addRelationships(a.relationships)),this._TYPE}}},_parseGetterForArguments:{value:function(){var e,t,i,r;if(e={exports:arguments[0],name:arguments[1]},arguments.length>3&&this._isRealObject(arguments[2])?(e.types=arguments[2],t=3):t=2,Array.isArray(arguments[t]))e.identifiers=arguments[t],t+=1;else{for(i=t,r=arguments.length;i<r&&"string"==typeof arguments[i];i+=1)e.identifiers=Array.prototype.slice.call(arguments,t,i);t=i}return e.relationships=arguments[t],e}},_isRealObject:{value:function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!(e instanceof String)&&!(e instanceof Number)&&!(e instanceof Boolean)}}})}}),montageDefine("b7b5e36","data/model/object-descriptor",{dependencies:["core/core","data/model/property-descriptor"],factory:function(e,t,i){var r=e("core/core").Montage,n=e("data/model/property-descriptor").PropertyDescriptor;t.ObjectDescriptor=r.specialize({typeName:{value:void 0},objectPrototype:{value:r.prototype},propertyDescriptors:{get:function(){return this._propertyDescriptors||(this._propertyDescriptors={}),this._propertyDescriptors}},setPropertyDescriptor:{value:function(e,t){this.propertyDescriptors[e]=t}},deletePropertyDescriptor:{value:function(e){delete this.propertyDescriptors[e]}},makePropertyDescriptor:{value:function(){return new n}},_setPropertyDescriptorsFromTypes:{value:function(e){var t,i,r,n=Object.keys(e);for(t=0;r=n[t];++t)i=this.makePropertyDescriptor(),this.setPropertyDescriptor(r,i)}},_setPropertyDescriptorsFromPrototype:{value:function(e){for(var t,i,n,o;e!==r.prototype&&null!==e;e=Object.getPrototypeOf(e))for(t=Object.getOwnPropertyNames(e),n=0,o=t.length;n<o;n+=1)this.propertyDescriptors[t[n]]||(i=this.makePropertyDescriptor(),this.setPropertyDescriptor(t[n],i))}}},{getterFor:{value:function(e,t,i){var r=this;return function(){return this.hasOwnProperty("_TYPE")||(this._TYPE=new r,this._TYPE.typeName=t,this._TYPE.objectPrototype=e[t].prototype,i?this._TYPE._setPropertyDescriptorsFromTypes(i):this._TYPE._setPropertyDescriptorsFromPrototype(this._TYPE.objectPrototype)),this._TYPE}}}})}}),montageDefine("b7b5e36","composer/composer",{dependencies:["../core/target","../core/event/event-manager"],factory:function(e,t,i){var r=e("../core/target").Target,n=e("../core/event/event-manager").defaultEventManager;t.Composer=r.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},_shawdowRoot:{value:null},shawdowRoot:{get:function(){return this._shawdowRoot||(this._shawdowRoot=n.shawdowRootFromNode(this.element)),this._shawdowRoot}},lazyLoad:{value:!0},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:Function.noop},_resolveDefaults:{value:function(){this.element||null!==this.element||null===this.component||(this.element=this.component.element)}},_isLoaded:{value:!1},isLoaded:{get:function(){return this._isLoaded}},load:{value:Function.noop},unload:{value:Function.noop},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}},{isCoordinateOutsideRadius:{value:function(e,t,i){return e*e+t*t>i*i}}})}}),montageDefine("b7b5e36","core/meta/derived-descriptor",{dependencies:["./property-descriptor","../logger"],factory:function(e,t,i){var r=e("./property-descriptor").PropertyDescriptor,n=(e("../logger").logger("objectDescriptor"),{dependencies:[],getterDefinition:"",setterDefinition:""});t.DerivedDescriptor=r.specialize({serializeSelf:{value:function(e){this.dependencies.length>0&&this._setPropertyWithDefaults(e,"dependencies",this.dependencies),this._setPropertyWithDefaults(e,"getterDefinition",this.getterDefinition),this._setPropertyWithDefaults(e,"setterDefinition",this.setterDefinition)}},deserializeSelf:{value:function(e){this.dependencies=this._getPropertyWithDefaults(e,"dependencies"),this.getterDefinition=this._getPropertyWithDefaults(e,"getterDefinition"),this.setterDefinition=this._getPropertyWithDefaults(e,"setterDefinition")}},_setPropertyWithDefaults:{value:function(e,t,i){i!==n[t]&&e.setProperty(t,i)}},_getPropertyWithDefaults:{value:function(e,t){var i=e.getProperty(t);return i||this[t]||n[t]}},isDerived:{get:function(){return!0},serializable:!1},_dependencies:{value:null},dependencies:{get:function(){return this._dependencies||(this._dependencies=[])}},getterDefinition:{value:n.getterDefinition},setterDefinition:{value:n.setterDefinition}})}}),montageDefine("24e6f9c","ui/converter.reel/converter",{dependencies:["montage/ui/component","montage/core/criteria","logic/model/weather-report","logic/model/weather-report","logic/service/weather-service","logic/service/remote-data-service","montage/data/service/data-service","montage/data/service/data-selector"],factory:function(e,t,i){var r=e("montage/ui/component").Component,n=e("montage/core/criteria").Criteria,o=e("logic/model/weather-report").WeatherReport,a=(e("logic/model/weather-report").Type,e("logic/service/weather-service").WeatherService),s=(e("logic/service/remote-data-service").RemoteDataService,e("montage/data/service/data-service").DataService),l=e("montage/data/service/data-selector").DataSelector;t.Converter=r.specialize({constructor:{value:function(){var e=this;this["super"]();var t=new s;t.addChildService(new a);var i="city = $city && unit = $unit && country = $country",r={city:"San-Francisco",country:"us",unit:"imperial"},u=(new n).initWithExpression(i,r),c=o.TYPE,h=l.withTypeAndCriteria(c,u);t.fetchData(h).then(function(t){e.weatherReport=t[0]})}},_weatherReport:{value:null},weatherReport:{get:function(){return this._weatherReport},set:function(e){this._weatherReport!==e&&(this._weatherReport=e,this.needsDraw=!0)}}})}}),montageDefine("24e6f9c","ui/main.reel/main.html",{text:'<!DOCTYPE html><html><head><meta http-equiv=content-type content="text/html; charset=utf-8"><title>Main</title><style>*{-moz-box-sizing:border-box;box-sizing:border-box}body{margin:0;font-family:"Lucida Grande","Trebuchet MS",Verdana,sans-serif;color:hsl(0,0%,60%);background-color:hsl(0,0%,95%)}.Main{padding:3em 1em;text-align:center}.Title{font-size:1.3em}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"main"}}},"title":{"prototype":"ui/title.reel","properties":{"element":{"#":"title"}},"bindings":{"value":{"<->":"@owner.titleValue"}}},"tempConverter":{"prototype":"ui/converter.reel","properties":{"element":{"#":"tempConverter"}}},"montageVersion":{"prototype":"ui/version.reel","properties":{"element":{"#":"montageVersion"}}}}</script></head><body><div data-montage-id=main data-montage-skin=light class=Main><h1 data-montage-id=title class=Title></h1><div data-montage-id=tempConverter></div><footer data-montage-id=montageVersion></footer></div></body></html>'}),montageDefine("b7b5e36","core/meta/validation-semantics",{dependencies:["../core","../deprecate","../logger"],factory:function(e,t,i){var r=e("../core").Montage,n=r,o=e("../deprecate"),a=(e("../logger").logger("objectDescriptor"),t.PropertyValidationSemantics=n.specialize({initWithObjectDescriptor:{value:function(e){return this._objectDescriptor=e,this}},_objectDescriptor:{value:void 0},objectDescriptor:{get:function(){return this._objectDescriptor}},compile:{value:function(e,t){n.compile.call(this,e,t)}},operators:{value:{isBound:function(e){return!e}}},evaluators:{value:{isBound:function(e,t){var i=this;return function(r,n){return r=i.count(e(r,n)),t(r,n)}}}},initWithBlueprint:{value:o.deprecateMethod(void 0,function(e){return this.initWithObjectDescriptor(e)},"initWithBlueprint","initWithObjectDescriptor")},blueprint:{get:o.deprecateMethod(void 0,function(){return this._blueprint},"blueprint","objectDescriptor")}}));for(var s in n.operators)n.operators.hasOwnProperty(s)&&(a.operators[s]=n.operators[s]);for(var l in n.evaluators)n.evaluators.hasOwnProperty(l)&&(a.evaluators[l]=n.evaluators[l])}}),montageDefine("b7b5e36","core/exception",{dependencies:["./core","./logger"],factory:function(e,t,i){var r=e("./core").Montage;e("./logger").logger("exception"),t.Exception=r.specialize({message:{value:null},target:{value:null},method:{value:null},initWithMessage:{enumerable:!0,value:function(e){return this.initWithMessageTargetAndMethod(e,null,null)}},initWithMessageAndTarget:{enumerable:!0,value:function(e,t){return this.initWithMessageTargetAndMethod(e,t,null)}},initWithMessageTargetAndMethod:{enumerable:!0,value:function(e,t,i){return this.message="undefined"!=typeof e?e:null,Object.defineProperty(this,"message",{writable:!1}),this.target="undefined"!=typeof t?t:null,Object.defineProperty(this,"target",{writable:!1}),this.method="undefined"!=typeof i?i:null,Object.defineProperty(this,"method",{writable:!1}),this}},toString:{enumerable:!1,value:function(){return"Exception: "+(null!==this.message?this.message+" ":null)+(null!==this.target?this.target+" ":null)+(null!==this.method?this.method+" ":null)}}})}}),montageDefine("24e6f9c","logic/service/weather-service",{dependencies:["montage/data/service/http-service","montage/data/service/data-service","montage/data/service/data-selector","../model/weather-report"],factory:function(e,t,i){var r=e("montage/data/service/http-service").HttpService;e("montage/data/service/data-service").DataService,e("montage/data/service/data-selector").DataSelector,e("../model/weather-report").WeatherReport,t.WeatherService=r.specialize({API_KEY:{value:"7593a575795cbd73f54c69a321ed86fe"},ENDPOINT:{value:"http://api.openweathermap.org/data/2.5/"},fetchRawData:{value:function(e){var t=this,i=e.selector.criteria;return t.fetchHttpRawData(this._getUrl(i,!0),!1).then(function(r){r&&(t.addRawData(e,[r],i),t.rawDataDone(e))})}},mapFromRawData:{value:function(e,t,i){e.temp=t.main.temp}},_getUrl:{value:function(e,t){var i=e.parameters;return this.ENDPOINT+"weather?q="+i.city+","+i.country+"&units="+i.unit+"&appid="+this.API_KEY}}})}}),montageDefine("b7b5e36","ui/text.reel/text",{dependencies:["../component"],factory:function(e,t,i){var r=e("../component").Component,n=t.Text=r.specialize({hasTemplate:{value:!1},_value:{value:null},value:{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.needsDraw=!0)}},converter:{value:null},defaultValue:{value:""},_valueNode:{value:null},_RANGE:{value:document.createRange()},enterDocument:{value:function(e){if(e){var t=this._RANGE;t.selectNodeContents(this.element),t.deleteContents(),this._valueNode=document.createTextNode(""),t.insertNode(this._valueNode),this.element.classList.add("montage-Text")}}},draw:{value:function(){var e="undefined"!=typeof this._value&&null!==this._value?this._value:this.defaultValue;this._valueNode.data=this.converter?this.converter.convert(e):e}}});window.MontageElement&&MontageElement.define("montage-text",n,{observedAttributes:["value"]})}}),montageDefine("b7b5e36","data/model/data-identifier",{dependencies:["core/core"],factory:function(e,t,i){var r=e("core/core").Montage;t.DataIdentifier=r.specialize({dataService:{value:void 0},objectDescriptor:{value:void 0},primaryKey:{value:void 0},_typeName:{value:void 0},typeName:{get:function(){return this._typeName||(this._typeName=this.objectDescriptor?this.objectDescriptor.name:"MISSING_TYPE_NAME")},set:function(e){this._typeName=e}},isPersistent:{value:!1},_identifier:{value:!1},_url:{value:void 0},url:{get:function(){if(!this._url){var e="montage-data://";e+=this.dataService.identifier,e+="/",e+=this.dataService.connectionDescriptor?this.dataService.connectionDescriptor.name:"default",e+="/",e+=this.objectDescriptor.name,e+="/",e+=this.primaryKey,this._url=e}return this._url},set:function(e){return this._url=e}}})}}),montageDefine("b7b5e36","ui/base/abstract-control",{dependencies:["../component","collections/map"],factory:function(e,t,i){var r=e("../component").Component,n=e("collections/map");t.AbstractControl=r.specialize({dispatchActionEvent:{value:function(){return this.dispatchEvent(this.createActionEvent())}},_detail:{value:null},detail:{get:function(){return null!==this._detail&&void 0!==this._detail||(this._detail=new n),this._detail}},createActionEvent:{value:function(){var e,t=document.createEvent("CustomEvent");return e=this._detail,t.initCustomEvent("action",!0,!0,e),t}},disabled:{get:function(){return!this.enabled},set:function(e){"boolean"==typeof e&&(this.enabled=!e)}}})}}),montageDefine("b7b5e36","data/model/data-query",{dependencies:["montage"],factory:function(e,t,i){var r=e("montage").Montage;t.DataQuery=r.specialize({type:{value:void 0},criteria:{get:function(){return this._criteria||(this._criteria={}),this._criteria},set:function(e){this._criteria=e}},_criteria:{value:void 0},orderings:{get:function(){return this._orderings||(this._orderings=[]),this._orderings},set:function(e){this._orderings=e}},_orderings:{value:void 0},selectBindings:{value:void 0},selectExpression:{value:void 0},prefetchExpressions:{value:null}},{withTypeAndCriteria:{value:function(e,t){var i;return i=new this,i.type=e,i.criteria=t,i}}})}}),montageDefine("b7b5e36","data/service/data-mapping",{dependencies:["core/core"],factory:function(e,t,i){var r=e("core/core").Montage;t.DataMapping=r.specialize({mapRawDataToObject:{value:function(e,t,i){var r,n,o=Object.keys(e);if(e)for(r=0;n=o[r];++r)t[n]=e[n]}},mapObjectToRawData:{value:function(e,t){}},nullPromise:{get:function(){return this._nullPromise||(this._nullPromise=Promise.resolve(null)),this._nullPromise}},mapFromRawData:{value:function(e,t,i){this.mapRawDataToObject(t,e,i)}},mapToRawData:{value:function(e,t){this.mapObjectToRawData(e,t)}}},{withObjectDescriptor:{value:function(e){var t=new this;return t._descriptor=e,t}}})}}),montageDefine("24e6f9c","ui/version.reel/version.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Version{color:hsl(0,0%,80%)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"version"}}},"montageVersion":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"montageVersion"}},"bindings":{"value":{"<-":"@owner.montageDescription.version"}}}}</script></head><body><footer data-montage-id=version class=Version>Montage version: <span data-montage-id=montageVersion></span></footer></body></html>'}),montageDefine("24e6f9c","logic/model/weather-report",{dependencies:["montage","montage/data/model/data-object-descriptor"],factory:function(e,t,i){var r=e("montage").Montage;e("montage/data/model/data-object-descriptor").DataObjectDescriptor,t.WeatherReport=WeatherReport=r.specialize({temp:{value:null},constructor:{value:function(){}}},{TYPE:{get:function(){return WeatherReport.objectPrototype=WeatherReport,WeatherReport}}})}}),montageDefine("b7b5e36","data/service/authorization-policy",{dependencies:["core/core"],factory:function(e,t,i){var r=e("core/core").Montage,n=t.AuthorizationPolicy=r.specialize({id:{value:void 0}},{withID:{value:function(e){var t=new this;return t.id=e,t}}});n.ON_DEMAND=n.withID("ON_DEMAND"),n.ON_FIRST_FETCH=n.withID("ON_FIRST_FETCH"),n.NONE=n.withID("NONE"),n.UP_FRONT=n.withID("UP_FRONT")}}),montageDefine("cf0fb3f","ui/title.reel/title.html",{text:'<!DOCTYPE html><html><head><title></title><style>.digit-Title{margin:0;padding:0;font-size:1.5em;line-height:1.5}[data-montage-skin="light"] .digit-Title{color:hsl(0,0%,40%);text-shadow:0 1px 0 hsla(0,0%,100%,.8)}[data-montage-skin="dark"] .digit-Title{color:hsl(0,0%,80%)}</style></head><body></body></html>'}),montageDefine("24e6f9c","ui/version.reel/version",{dependencies:["montage/ui/component"],factory:function(e,t,i){var r=e("montage/ui/component").Component;t.Version=r.specialize({constructor:{value:function(){this["super"]()}},montageDescription:{get:function(){return("undefined"!=typeof montageRequire?montageRequire:mr).packageDescription}}})}}),montageDefine("cf0fb3f","ui/button.reel/button",{dependencies:["montage/ui/base/abstract-button"],factory:function(e,t,i){var r=e("montage/ui/base/abstract-button").AbstractButton;t.Button=r.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"](),this.classList.add("digit-Button")}}})}}),montageDefine("cf0fb3f","ui/text-field.reel/text-field",{dependencies:["montage/ui/base/abstract-text-field"],factory:function(e,t,i){var r=e("montage/ui/base/abstract-text-field").AbstractTextField;t.TextField=r.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"]()}}})}}),montageDefine("b7b5e36","data/service/data-provider",{dependencies:["core/core","core/promise"],factory:function(e,t,i){var r=e("core/core").Montage,n=e("core/promise").Promise;t.DataProvider=r.specialize({data:{value:void 0},requestData:{value:function(e,t){return n.resolve(this.data)}}})}}),montageDefine("cf0fb3f","ui/number-field.reel/number-field",{dependencies:["montage/ui/base/abstract-number-field"],factory:function(e,t,i){var r=e("montage/ui/base/abstract-number-field").AbstractNumberField;t.NumberField=r.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("24e6f9c","ui/main.reel/main",{dependencies:["montage/ui/component"],factory:function(e,t,i){var r=e("montage/ui/component").Component;t.Main=r.specialize({constructor:{value:function(){this["super"]()}},titleValue:{get:function(){return"Temperature Converter"}}})}}),montageDefine("cf0fb3f","ui/title.reel/title",{dependencies:["montage/ui/text.reel"],factory:function(e,t,i){var r=e("montage/ui/text.reel").Text;t.Title=r.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"](),this.classList.add("digit-Title")}}})}}),montageDefine("b7b5e36","data/model/data-property-descriptor",{dependencies:["data/model/property-descriptor"],factory:function(e,t,i){var r=e("data/model/property-descriptor").PropertyDescriptor;t.DataPropertyDescriptor=r.specialize({isGlobal:{value:!1}})}}),montageDefine("cf0fb3f","ui/slider.reel/slider",{dependencies:["montage/ui/base/abstract-slider"],factory:function(e,t,i){var r=e("montage/ui/base/abstract-slider").AbstractSlider;t.Slider=r.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("24e6f9c","ui/title.reel/title",{
dependencies:["digit/ui/title.reel"],factory:function(e,t,i){var r=e("digit/ui/title.reel").Title;t.Title=r.specialize({constructor:{value:function(){this["super"](),this.classList.add("my-Title")}}})}}),montageDefine("b7b5e36","data/model/property-descriptor",{dependencies:["core/core"],factory:function(e,t,i){var r=e("core/core").Montage;t.PropertyDescriptor=r.specialize({isRelationship:{value:!1},isOptional:{value:!1}})}}),montageDefine("b7b5e36","data/service/data-selector",{dependencies:["data/model/data-selector"],factory:function(e,t,i){var r=e("data/model/data-selector").DataSelector;t.DataSelector=r}}),montageDefine("b7b5e36","data/model/data-selector",{dependencies:["data/model/data-query"],factory:function(e,t,i){var r=e("data/model/data-query").DataQuery;t.DataSelector=r}}),montageDefine("b7b5e36","core/selector",{dependencies:["./criteria"],factory:function(e,t,i){var r=e("./criteria").Criteria;t.Selector=r}}),montageDefine("24e6f9c","ui/title.reel/title.html",{text:"<!DOCTYPE html><html><head><title></title></head><body></body></html>"});
bundleLoaded("index.html.bundle-1-0.js")